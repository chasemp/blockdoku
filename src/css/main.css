/* Reset and base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    line-height: 1.6;
    background: linear-gradient(135deg, var(--bg-color) 0%, var(--header-bg) 100%);
    color: var(--text-color);
    transition: all 0.3s ease;
    min-height: 100vh;
}

/* Layout */
#app {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.header {
    background: linear-gradient(135deg, var(--header-bg) 0%, var(--primary-color) 100%);
    padding: 1.65rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-color);
}

/* UTILITY BAR: Optional items controlled by gamesettings.html (hints, timer, personal best, speed timer) */
.utility-bar {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-bottom: 1px solid var(--border-color);
    background: linear-gradient(135deg, var(--header-bg) 0%, var(--cell-bg) 100%);
    transition: all 0.3s ease;
    min-height: 100px;
    position: relative;
    z-index: 5; /* Lower than game-info to stay behind */
}

/* Utility slots - static positions for items */
.utility-slot {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 80px;
    position: relative;
    flex: 1;
}

.utility-item {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition: all 0.3s ease;
}

/* Inactive slot styling - subtle placeholder */
.utility-item:not(.active) {
    opacity: 0.3;
    transform: scale(0.95);
}

.utility-item:not(.active)::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    z-index: 1;
}

.utility-item:not(.active) .utility-item-content {
    opacity: 0;
}

/* Active slot styling - "lit up" effect */
.utility-item.active {
    opacity: 1;
    transform: scale(1);
    animation: utilityGlow 2s ease-in-out infinite alternate;
}

.utility-item.active .utility-item-content {
    background: rgba(0, 123, 255, 0.1);
    border: 1px solid rgba(0, 123, 255, 0.3);
    box-shadow: 0 0 10px rgba(0, 123, 255, 0.2);
}

@keyframes utilityGlow {
    0% {
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.3);
        filter: brightness(1);
    }
    100% {
        box-shadow: 0 0 15px rgba(0, 123, 255, 0.6);
        filter: brightness(1.1);
    }
}

/* Special styling for different utility items when active */
.utility-item.active .personal-bests {
    background: rgba(255, 215, 0, 0.15);
    border-color: rgba(255, 215, 0, 0.4);
    color: #ffd700;
}

.utility-item.active .timer {
    background: rgba(255, 68, 68, 0.15);
    border-color: rgba(255, 68, 68, 0.4);
}

.utility-item.active .speed-timer {
    background: rgba(255, 107, 53, 0.15);
    border-color: rgba(255, 107, 53, 0.4);
    box-shadow: 0 0 10px rgba(255, 107, 53, 0.2);
}

.utility-item.active .hint-controls {
    background: rgba(255, 215, 0, 0.15);
    border-color: rgba(255, 215, 0, 0.4);
}

/* Slot-specific positioning */
.utility-slot-left {
    justify-content: flex-start;
}

.utility-slot-center {
    justify-content: center;
}

.utility-slot-center-right {
    justify-content: center;
}

.utility-slot-right {
    justify-content: flex-end;
}

/* Collapsed state when no content */
.utility-bar:not(.has-content) {
    padding: 0.1rem 1rem;
    min-height: 1rem;
    opacity: 0.7;
}

.utility-bar.has-content {
    padding: 0.5rem 1rem;
    min-height: 100px;
    opacity: 1;
}

/* Utility item content styling - CONSISTENT SIZE FOR ALL ITEMS */
.utility-item-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    transition: all 0.3s ease;
    padding: 0.5rem;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.1);
    min-width: 80px;
    min-height: 80px; /* CONSISTENT HEIGHT FOR ALL */
    gap: 0.3rem;
    overflow: hidden;
    position: relative;
}

.personal-bests {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.3rem;
    font-weight: 600;
    color: var(--text-color);
    border-color: rgba(255, 215, 0, 0.3);
    padding: 0.5rem;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 215, 0, 0.3);
    min-width: 80px;
    min-height: 80px; /* CONSISTENT HEIGHT */
}

.personal-bests .pb-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #ffd700;
    text-shadow: 0 0 3px #ffd700;
    text-align: center;
    width: 100%;
}

.personal-bests .pb-value {
    font-family: 'Courier New', 'Monaco', 'Lucida Console', monospace;
    font-weight: bold;
    font-size: 1.2rem;
    padding: 0.3rem 0.6rem;
    background: #000;
    color: #ffffff;
    border-radius: 6px;
    border: 2px solid #333;
    box-shadow: 
        inset 0 0 10px rgba(255, 255, 255, 0.3),
        0 0 20px rgba(255, 255, 255, 0.2),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 5px #ffffff,
        0 0 10px #ffffff,
        0 0 15px #ffffff;
    position: relative;
    overflow: hidden;
    min-width: 60px;
    text-align: center;
}

.header h1 {
    font-size: 1.8rem;
    font-weight: 700;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    letter-spacing: -0.5px;
}

.logo-container {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.game-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.app-logo {
    height: 72px; /* 20% bigger than 60px (60 * 1.2 = 72) */
    width: auto;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    transition: transform 0.2s ease;
    object-fit: contain; /* Maintain aspect ratio */
}

.app-logo:hover {
    transform: scale(1.05);
}

/* Responsive logo sizing */
@media (max-width: 768px) {
    .app-logo {
        height: 60px; /* 20% bigger than 50px (50 * 1.2 = 60) */
    }
}

@media (max-width: 480px) {
    .app-logo {
        height: 48px; /* 20% bigger than 40px (40 * 1.2 = 48) */
    }
}

.controls {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.main {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2rem 2rem 2rem 2rem;
}

.game-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    width: 100%;
    max-width: 500px;
}

.game-board-container {
    position: relative;
    border: 3px solid var(--border-color);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    background: linear-gradient(135deg, var(--board-bg) 0%, var(--cell-bg) 100%);
    transition: all 0.3s ease;
    width: 450px;
    height: 450px;
    margin: 0 auto;
}

.game-board-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
}

#game-board {
    display: block;
    background-color: var(--board-bg);
    cursor: pointer;
    transition: all 0.2s ease;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    width: 100%;
    height: 100%;
}

#game-board:hover {
    filter: brightness(1.05);
}

.board-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

/* SCORING BAR: Always visible score, level, and combo display */
.game-info {
    display: flex;
    gap: 1.5rem;
    font-size: 1.65rem; /* 50% increase from 1.1rem */
    font-weight: 600;
    flex-wrap: wrap;
    justify-content: center;
    background: linear-gradient(135deg, var(--header-bg) 0%, var(--cell-bg) 100%);
    padding: 1rem 1.5rem;
    border-radius: 0;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    border: none;
    border-bottom: 1px solid var(--border-color);
    width: 100%;
    margin: 0;
    position: relative;
    z-index: 100; /* Increased from 10 to ensure it's always on top */
}

.game-info > div {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
    padding: 0.6rem 0.6rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    min-width: 80px;
    flex: 1;
    box-sizing: border-box;
    overflow: visible; /* Allow animations and effects to show */
    min-height: 50px;
    position: relative; /* Create stacking context */
    z-index: 1; /* Ensure proper layering */
}

.game-info span:first-child {
    font-size: 1.125rem; /* 50% increase from 0.75rem */
    opacity: 0.95;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    font-weight: 600;
    white-space: nowrap;
    max-width: 100%;
}

.game-info span:last-child {
    font-size: 2.25rem; /* 50% increase from 1.5rem */
    font-weight: 900;
    color: var(--primary-color);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
    white-space: nowrap;
    max-width: 100%;
    line-height: 1.1;
    letter-spacing: 0.5px;
}

/* Speed timer styling - LED-style consistency */
.speed-timer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.3rem;
    font-weight: 600;
    color: var(--text-color);
    border-color: rgba(255, 107, 53, 0.3);
    min-height: 80px; /* CONSISTENT HEIGHT */
}

.speed-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #ff8c42;
    text-shadow: 0 0 3px rgba(255, 140, 66, 0.6);
    text-align: center;
    width: 100%;
}

.speed-value {
    font-family: 'Courier New', 'Monaco', 'Lucida Console', monospace;
    font-weight: bold;
    font-size: 1.2rem;
    padding: 0.3rem 0.6rem;
    background: #000;
    color: #cc4a2a;
    border-radius: 6px;
    border: 2px solid #333;
    box-shadow: 
        inset 0 0 10px rgba(204, 74, 42, 0.2),
        0 0 20px rgba(204, 74, 42, 0.12),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 3px #cc4a2a,
        0 0 6px #cc4a2a,
        0 0 9px #cc4a2a;
    position: relative;
    overflow: hidden;
    min-width: 60px;
    text-align: center;
}

@keyframes speedPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.speed-pulse {
    animation: speedPulse 0.6s ease-out;
}

/* Speed timer text animation */
@keyframes speedTimerFloat {
    0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(0.8);
    }
    50% {
        opacity: 1;
        transform: translate(-50%, -70px) scale(1.1);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -100px) scale(1);
    }
}

.speed-timer-text {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Hint controls styling - LED-style consistency */
.hint-controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.3rem;
    font-weight: 600;
    color: var(--text-color);
    border-color: rgba(255, 215, 0, 0.3);
    min-height: 80px; /* CONSISTENT HEIGHT */
}

.hint-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #ffd700;
    text-shadow: 0 0 3px #ffd700;
    text-align: center;
    width: 100%;
}

.btn-hint {
    font-family: 'Courier New', 'Monaco', 'Lucida Console', monospace;
    font-weight: bold;
    font-size: 1.2rem;
    padding: 0.3rem 0.6rem;
    background: #000;
    color: #ffd700;
    border-radius: 6px;
    border: 2px solid #333;
    box-shadow: 
        inset 0 0 10px rgba(255, 215, 0, 0.3),
        0 0 20px rgba(255, 215, 0, 0.2),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 5px #ffd700,
        0 0 10px #ffd700,
        0 0 15px #ffd700;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    min-width: 60px;
    text-transform: uppercase;
    text-align: center;
}

.btn-hint:hover:not(:disabled) {
    background: #111;
    color: #ffed4e;
    text-shadow: 
        0 0 8px #ffed4e,
        0 0 15px #ffed4e,
        0 0 25px #ffed4e;
    box-shadow: 
        inset 0 0 15px rgba(255, 215, 0, 0.4),
        0 0 30px rgba(255, 215, 0, 0.4),
        0 2px 4px rgba(0, 0, 0, 0.5);
    transform: translateY(-1px);
}

.btn-hint:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
    color: #666;
    text-shadow: none;
    box-shadow: 
        inset 0 0 5px rgba(255, 215, 0, 0.1),
        0 0 5px rgba(255, 215, 0, 0.1),
        0 2px 4px rgba(0, 0, 0, 0.5);
}

/* Timer display styling - Retro LED countdown clock */
.timer {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.3rem;
    font-weight: 600;
    color: var(--text-color);
    border-color: rgba(255, 68, 68, 0.3);
    min-height: 80px; /* CONSISTENT HEIGHT */
}

.timer-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #ff4444;
    text-shadow: 0 0 3px #ff4444;
    text-align: center;
    width: 100%;
}

.timer-value {
    font-family: 'Courier New', 'Monaco', 'Lucida Console', monospace;
    font-weight: bold;
    font-size: 1.2rem;
    padding: 0.3rem 0.6rem;
    background: #000;
    color: #ff4444;
    border-radius: 6px;
    border: 2px solid #333;
    box-shadow: 
        inset 0 0 10px rgba(255, 68, 68, 0.3),
        0 0 20px rgba(255, 68, 68, 0.2),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 5px #ff4444,
        0 0 10px #ff4444,
        0 0 15px #ff4444;
    letter-spacing: 2px;
    position: relative;
    overflow: hidden;
    min-width: 60px;
    text-align: center;
}

/* LED segments effect */
.timer span:last-child::before {
    content: '88:88';
    position: absolute;
    top: 0.4rem;
    left: 0.8rem;
    color: #330000;
    text-shadow: none;
    z-index: -1;
}

/* Theme-specific LED styling */

/* Wood Theme - Warm amber LED */
.wood-theme .timer span:first-child,
[data-theme="wood"] .timer span:first-child,
.wood-theme .speed-label,
[data-theme="wood"] .speed-label,
.wood-theme .pb-label,
[data-theme="wood"] .pb-label {
    color: #cc8800;
    text-shadow: 0 0 3px rgba(204, 136, 0, 0.6);
}

.wood-theme .timer span:last-child,
[data-theme="wood"] .timer span:last-child,
.wood-theme .btn-hint,
[data-theme="wood"] .btn-hint,
.wood-theme .speed-value,
[data-theme="wood"] .speed-value,
.wood-theme .pb-value,
[data-theme="wood"] .pb-value {
    background: #2a1810;
    color: #cc8800;
    border-color: #5d3a1a;
    box-shadow: 
        inset 0 0 10px rgba(204, 136, 0, 0.2),
        0 0 20px rgba(204, 136, 0, 0.12),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 3px #cc8800,
        0 0 6px #cc8800,
        0 0 9px #cc8800;
}

.wood-theme .timer span:last-child::before,
[data-theme="wood"] .timer span:last-child::before {
    color: #332200;
}

/* Dark Theme - Blue-white LED */
.dark-theme .timer span:first-child,
[data-theme="dark"] .timer span:first-child,
.dark-theme .speed-label,
[data-theme="dark"] .speed-label,
.dark-theme .pb-label,
[data-theme="dark"] .pb-label {
    color: #0088cc;
    text-shadow: 0 0 3px rgba(0, 136, 204, 0.6);
}

.dark-theme .timer span:last-child,
[data-theme="dark"] .timer span:last-child,
.dark-theme .btn-hint,
[data-theme="dark"] .btn-hint,
.dark-theme .speed-value,
[data-theme="dark"] .speed-value,
.dark-theme .pb-value,
[data-theme="dark"] .pb-value {
    background: #0a0a0a;
    color: #0088cc;
    border-color: #222;
    box-shadow: 
        inset 0 0 10px rgba(0, 136, 204, 0.2),
        0 0 20px rgba(0, 136, 204, 0.12),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 3px #0088cc,
        0 0 6px #0088cc,
        0 0 9px #0088cc;
}

.dark-theme .timer span:last-child::before,
[data-theme="dark"] .timer span:last-child::before {
    color: #001133;
}

/* Light Theme - Green LED for better contrast */
.light-theme .timer span:first-child,
[data-theme="light"] .timer span:first-child,
.light-theme .speed-label,
[data-theme="light"] .speed-label,
.light-theme .pb-label,
[data-theme="light"] .pb-label {
    color: #008800;
    text-shadow: 0 0 3px rgba(0, 136, 0, 0.6);
}

.light-theme .timer span:last-child,
[data-theme="light"] .timer span:last-child,
.light-theme .btn-hint,
[data-theme="light"] .btn-hint,
.light-theme .speed-value,
[data-theme="light"] .speed-value,
.light-theme .pb-value,
[data-theme="light"] .pb-value {
    background: #1a1a1a;
    color: #00cc00;
    border-color: #333;
    box-shadow: 
        inset 0 0 10px rgba(0, 204, 0, 0.2),
        0 0 20px rgba(0, 204, 0, 0.12),
        0 2px 4px rgba(0, 0, 0, 0.5);
    text-shadow: 
        0 0 3px #00cc00,
        0 0 6px #00cc00,
        0 0 9px #00cc00;
}

.light-theme .timer span:last-child::before,
[data-theme="light"] .timer span:last-child::before {
    color: #003300;
}

/* Warning state - Orange LED (universal across themes) */
.timer.warning span:last-child {
    color: #ff8800 !important;
    text-shadow: 
        0 0 5px #ff8800,
        0 0 10px #ff8800,
        0 0 15px #ff8800 !important;
    box-shadow: 
        inset 0 0 10px rgba(255, 136, 0, 0.3),
        0 0 20px rgba(255, 136, 0, 0.2),
        0 2px 4px rgba(0, 0, 0, 0.5) !important;
}

.timer.warning span:first-child {
    color: #ff8800 !important;
    text-shadow: 0 0 3px #ff8800 !important;
}

.timer.warning span:last-child::before {
    color: #332200 !important;
}

/* Critical state - Bright red pulsing LED (universal across themes) */
.timer.critical span:last-child {
    color: #ff0000 !important;
    text-shadow: 
        0 0 8px #ff0000,
        0 0 15px #ff0000,
        0 0 25px #ff0000 !important;
    box-shadow: 
        inset 0 0 15px rgba(255, 0, 0, 0.4),
        0 0 30px rgba(255, 0, 0, 0.4),
        0 2px 4px rgba(0, 0, 0, 0.5) !important;
    animation: led-pulse 0.5s infinite alternate !important;
}

.timer.critical span:first-child {
    color: #ff0000 !important;
    text-shadow: 0 0 5px #ff0000 !important;
    animation: led-pulse 0.5s infinite alternate !important;
}

.timer.critical span:last-child::before {
    color: #330000 !important;
}

/* LED pulse animation for critical time */
@keyframes led-pulse {
    0% { 
        text-shadow: 
            0 0 5px #ff0000,
            0 0 10px #ff0000,
            0 0 15px #ff0000 !important;
        box-shadow: 
            inset 0 0 10px rgba(255, 0, 0, 0.3),
            0 0 20px rgba(255, 0, 0, 0.3),
            0 2px 4px rgba(0, 0, 0, 0.5) !important;
    }
    100% { 
        text-shadow: 
            0 0 10px #ff0000,
            0 0 20px #ff0000,
            0 0 30px #ff0000 !important;
        box-shadow: 
            inset 0 0 20px rgba(255, 0, 0, 0.5),
            0 0 40px rgba(255, 0, 0, 0.5),
            0 2px 4px rgba(0, 0, 0, 0.5) !important;
    }
}

/* Timer pulse animation for critical time */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Difficulty button styling */
.difficulty-btn {
    min-width: 80px;
    text-align: center;
    font-weight: 600;
    text-transform: capitalize;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

/* Difficulty-specific theming */
.difficulty-btn.easy {
    background: linear-gradient(135deg, #4CAF50, #66BB6A);
    border-color: #388E3C;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
}

.difficulty-btn.easy:hover {
    background: linear-gradient(135deg, #66BB6A, #4CAF50);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
}

.difficulty-btn.normal {
    background: linear-gradient(135deg, #2196F3, #42A5F5);
    border-color: #1976D2;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);
}

.difficulty-btn.normal:hover {
    background: linear-gradient(135deg, #42A5F5, #2196F3);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
}

.difficulty-btn.hard {
    background: linear-gradient(135deg, #FF9800, #FFB74D);
    border-color: #F57C00;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3);
}

.difficulty-btn.hard:hover {
    background: linear-gradient(135deg, #FFB74D, #FF9800);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(255, 152, 0, 0.4);
}

.difficulty-btn.expert {
    background: linear-gradient(135deg, #F44336, #EF5350);
    border-color: #D32F2F;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0 2px 8px rgba(244, 67, 54, 0.3);
    animation: expert-pulse 2s infinite;
}

.difficulty-btn.expert:hover {
    background: linear-gradient(135deg, #EF5350, #F44336);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
}

/* Expert difficulty pulse animation */
@keyframes expert-pulse {
    0%, 100% { 
        box-shadow: 0 2px 8px rgba(244, 67, 54, 0.3);
    }
    50% { 
        box-shadow: 0 2px 12px rgba(244, 67, 54, 0.5);
    }
}

/* New game button styling to match difficulty button */
.new-game-btn {
    min-width: 80px;
    text-align: center;
    font-weight: 600;
}

/* Settings and Game Settings button styling to match other buttons */
#settings-toggle,
#game-settings-toggle {
    min-width: 50px; /* Narrower to fit icons better */
    text-align: center;
    font-weight: 600;
    font-size: 1.2rem;
    padding: 0.5rem;
}

.footer {
    background-color: var(--footer-bg);
    padding: 1rem 2rem;
    text-align: center;
    font-size: 0.9rem;
    color: var(--text-muted);
}

/* Buttons */
.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.btn:hover::before {
    left: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
}

.btn-secondary {
    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--border-color);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.btn-secondary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

/* Block Palette Styles */
.block-palette {
    background: linear-gradient(135deg, var(--header-bg) 0%, var(--cell-bg) 100%);
    padding: 2rem;
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    width: 100%;
    max-width: 700px;
    min-height: 120px; /* Fixed minimum height */
    height: 120px; /* Fixed height */
    border: 1px solid var(--border-color);
    backdrop-filter: blur(10px);
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* Block Points Display */
.block-info {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}

.block-points {
    position: absolute;
    top: -8px;
    right: -8px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    border: 2px solid var(--bg-color);
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 700;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    z-index: 10;
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.3s ease;
}

.block-info.show-points .block-points {
    opacity: 1;
    transform: scale(1);
}

/* Block points overlay styles removed - using circular badge only */

/* Difficulty Notes */
.difficulty-note {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-style: italic;
    margin-top: 0.25rem;
    padding: 0.25rem 0.5rem;
    background: var(--card-bg);
    border-radius: 4px;
    border-left: 3px solid var(--primary-color);
}

/* Speed Tracking Mode Section */
.speed-tracking-mode-settings {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.speed-tracking-mode-settings h3 {
    margin: 0 0 1rem 0;
    color: var(--text-color);
    font-size: 1.2rem;
    text-align: center;
}

.speed-mode-options {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.speed-mode-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-color);
    transition: all 0.3s ease;
    flex: 1;
    min-width: 120px;
    text-align: center;
}

.speed-mode-option:hover {
    border-color: var(--primary-color);
    background: var(--cell-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.speed-mode-option input[type="radio"] {
    display: none;
}

.speed-mode-option:has(input:checked) {
    border-color: var(--primary-color);
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
    color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.speed-mode-option:has(input:checked) .speed-mode-label {
    color: white;
}

.speed-mode-option:has(input:checked) .speed-mode-label strong {
    color: white;
    font-weight: 600;
}

.speed-mode-option:has(input:checked) .speed-mode-label small {
    color: rgba(255, 255, 255, 0.9);
}

.speed-mode-label {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
    flex: 1;
}

.speed-mode-label strong {
    color: var(--text-color);
    font-size: 1rem;
    transition: color 0.3s ease;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.speed-mode-label small {
    color: var(--text-muted);
    font-size: 0.85rem;
    line-height: 1.4;
    text-align: center;
}

/* Animation Speed Options - match speed mode styling */
.animation-speed-options {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.animation-speed-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-color);
    transition: all 0.3s ease;
    flex: 1;
    min-width: 120px;
    text-align: center;
}

.animation-speed-option:hover {
    border-color: var(--primary-color);
    background: var(--cell-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.animation-speed-option input[type="radio"] {
    display: none;
}

.animation-speed-option:has(input:checked) {
    border-color: var(--primary-color);
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
    color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.animation-speed-option:has(input:checked) .animation-speed-label {
    color: white;
}

.animation-speed-option:has(input:checked) .animation-speed-label strong {
    color: white;
    font-weight: 600;
}

.animation-speed-option:has(input:checked) .animation-speed-label small {
    color: rgba(255, 255, 255, 0.9);
}

.animation-speed-label {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
    flex: 1;
}

.animation-speed-label strong {
    color: var(--text-color);
    font-size: 1rem;
    transition: color 0.3s ease;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.animation-speed-label small {
    color: var(--text-muted);
    font-size: 0.85rem;
    line-height: 1.4;
    text-align: center;
}

/* Difficulty Comparison Bubbles */
.difficulty-short-desc {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

.difficulty-bubbles {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-top: 0.5rem;
    justify-content: center;
}

.difficulty-bubble {
    display: inline-flex;
    align-items: center;
    gap: 0.2rem;
    padding: 0.2rem 0.4rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    white-space: nowrap;
    transition: all 0.2s ease;
}

/* Match setting bubble colors - green and orange stand out, disabled blends with theme */
.bubble-enabled {
    background: linear-gradient(135deg, #44ff44 0%, #00cc00 100%);
    color: #1a1a1a;
    border: 1px solid #00cc00;
    box-shadow: 0 2px 6px rgba(68, 255, 68, 0.3);
}

.bubble-disabled {
    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%);
    color: var(--text-color);
    border: 1px solid var(--border-color);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    opacity: 0.7;
}

.bubble-neutral {
    background: linear-gradient(135deg, #ff9944 0%, #ff7700 100%);
    color: #1a1a1a;
    border: 1px solid #ff7700;
    box-shadow: 0 2px 6px rgba(255, 153, 68, 0.4);
}

.difficulty-bubble:hover {
    transform: translateY(-1px);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
}

/* Individual Setting Bubbles */
.individual-setting-bubble {
    display: inline-block;
    margin-bottom: 0.5rem;
    font-size: 0.7rem;
    padding: 0.15rem 0.35rem;
    border-radius: 10px;
}

.individual-setting-bubble:hover {
    transform: none; /* Disable hover transform for individual bubbles */
    cursor: default;
}

/* Setting item layout adjustments for bubbles */
.setting-item {
    position: relative;
}

.setting-item .individual-setting-bubble {
    margin-bottom: 0.3rem;
}

/* Difficulty Defaults Table */
.difficulty-defaults-table {
    text-align: center;
    margin: 1.5rem auto;
    max-width: 100%;
}

.difficulty-defaults-table h4 {
    text-align: center;
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.1rem;
    font-weight: 600;
}

.difficulty-defaults-table table {
    margin: 0 auto;
    border-collapse: collapse;
    width: 100%;
    max-width: 800px;
    background: var(--card-bg);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.difficulty-defaults-table th,
.difficulty-defaults-table td {
    padding: 0.75rem;
    text-align: center;
    border: 1px solid var(--border-color);
    color: var(--text-color);
}

.difficulty-defaults-table th {
    background: var(--primary-color);
    color: white;
    font-weight: 600;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.difficulty-defaults-table tr:nth-child(even) {
    background: var(--cell-hover);
}

.difficulty-defaults-table tr:hover {
    background: var(--cell-hover);
}

/* App Management Section */
.app-management-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.app-management-section h3 {
    margin: 0 0 1rem 0;
    color: var(--text-color);
    font-size: 1.2rem;
    text-align: center;
}

.app-management-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.app-management-buttons .pwa-install-button,
.app-management-buttons .reset-stats-button {
    width: 100%;
}

/* Difficulty Defaults Section */
.difficulty-defaults-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.difficulty-defaults-section h3 {
    margin: 0 0 1rem 0;
    color: var(--text-color);
    font-size: 1.2rem;
    text-align: center;
}

/* Reset Buttons Container */
.reset-buttons-container {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.reset-buttons-container .reset-button {
    width: 100%;
}

/* Reset Buttons */
.reset-button {
    background: var(--warning-color, #ff6b35);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.reset-button:hover {
    background: var(--warning-hover, #e55a2b);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.reset-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Toggle Button */
.toggle-button {
    background: var(--card-bg);
    border: 2px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-color);
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    padding: 0.75rem;
    width: 100%;
}

.toggle-button:hover {
    border-color: var(--primary-color);
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.toggle-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Difficulty Defaults Table */
#difficulty-defaults-table {
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    margin-top: 1rem;
    padding: 1.5rem;
    overflow-x: auto;
}

#difficulty-defaults-table h4 {
    margin: 0 0 1rem 0;
    color: var(--text-color);
    text-align: center;
}

#defaults-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
}

#defaults-table th {
    background: var(--primary-color);
    color: white;
    padding: 0.75rem;
    text-align: left;
    border: 1px solid var(--border-color);
}

#defaults-table th:not(:first-child) {
    text-align: center;
}

#defaults-table td {
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    vertical-align: top;
}

#defaults-table tr:nth-child(even) {
    background: var(--card-bg);
}

#defaults-table tr:hover {
    background: var(--hover-bg, rgba(0, 0, 0, 0.05));
}

.block-palette.pre-game-over {
    filter: grayscale(90%) brightness(0.6) opacity(0.85);
    transition: filter 0.25s ease;
}

.block-palette h3 {
    margin-bottom: 1.5rem;
    text-align: center;
    color: var(--text-color);
    font-size: 1.3rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.blocks-container {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    height: 100%;
    overflow: hidden; /* Prevent content from expanding the container */
}

.rotate-selected-btn {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 1.5rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
}

.rotate-selected-btn:hover:not(.disabled) {
    transform: translateY(-50%) translateY(-2px) scale(1.1);
    box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
}

.rotate-selected-btn:active:not(.disabled) {
    transform: translateY(-50%) scale(0.95);
}

.rotate-selected-btn.disabled {
    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%);
    color: var(--text-muted);
    cursor: not-allowed;
    opacity: 0.5;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.rotate-selected-btn.disabled:hover {
    transform: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.block-item {
    background: transparent;
    border: 2px solid transparent;
    border-radius: 8px;
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    min-width: 60px;
    text-align: center;
    position: relative;
    overflow: visible;
    display: flex;
    justify-content: center;
    align-items: center;
    touch-action: none;
    user-select: none;
    transform-origin: center;
    z-index: 1;
}

/* Palette placeability states */
.block-item.unplaceable {
    filter: grayscale(90%) brightness(0.5) opacity(0.4);
    cursor: not-allowed;
    pointer-events: none;
    position: relative;
}

.block-item.unplaceable::after {
    content: '✕';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #ff4444;
    font-size: 1.5rem;
    font-weight: bold;
    text-shadow: 0 0 3px rgba(0, 0, 0, 0.8);
    z-index: 10;
    pointer-events: none;
}

/* Expert mode: uniform piece colors for mental challenge */
.expert-mode .block-item {
    background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
    border-color: #718096;
    color: #e2e8f0;
}

.expert-mode .block-item:hover {
    background: linear-gradient(135deg, #5a6578 0%, #3d4758 100%);
    border-color: #81a1c1;
}

.expert-mode .block-item.selected {
    background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
    border-color: #9ca3af;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15), 0 0 15px rgba(156, 163, 175, 0.25);
}

/* Expert mode unplaceable pieces - still need clear visual distinction */
.expert-mode .block-item.unplaceable {
    filter: grayscale(95%) brightness(0.3) opacity(0.2);
    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    border-color: #4a5568;
}

.expert-mode .block-item.unplaceable::after {
    content: '✕';
    color: #ff6b6b;
    font-size: 1.8rem;
    text-shadow: 0 0 5px rgba(255, 107, 107, 0.8);
}

.block-item.placeable {
    filter: none;
    cursor: pointer;
    pointer-events: auto;
}

.block-item.last-playable {
    animation: lastPlayablePulse 0.6s ease-in-out infinite alternate;
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

@keyframes lastPlayablePulse {
    0% { transform: scale(1.05); box-shadow: 0 0 10px rgba(0,123,255,0.4); }
    100% { transform: scale(1.12); box-shadow: 0 0 18px rgba(0,123,255,0.6); }
}

/* Subtle hover effects */
.block-item:hover {
    transform: scale(1.05) translateY(-1px);
    border-color: var(--primary-color);
    background: radial-gradient(circle at center, rgba(0, 123, 255, 0.05) 0%, transparent 70%);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.1),
        0 0 8px rgba(0, 123, 255, 0.1);
    z-index: 10;
}

/* Subtle selection with gentle glow */
.block-item.selected {
    border-color: var(--primary-color);
    transform: scale(1.08) translateY(-1px);
    background: radial-gradient(circle at center, rgba(0, 123, 255, 0.08) 0%, transparent 70%);
    box-shadow: 
        0 6px 20px rgba(0, 0, 0, 0.15),
        0 0 15px rgba(0, 123, 255, 0.25);
    animation: block-selected-pulse 3s infinite ease-in-out;
    z-index: 15;
}

/* Dragging state: primary visual indication for block selection */
.block-item.dragging {
    filter: saturate(40%) brightness(0.8);
    opacity: 0.8;
    transform: scale(1.1);
    border: 2px solid var(--primary-color);
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
    transition: filter 0.1s ease, opacity 0.1s ease, transform 0.1s ease, border 0.1s ease, box-shadow 0.1s ease;
}

.block-item.dragging .block-preview canvas {
    filter: grayscale(40%);
}

/* Subtle particle effect overlay for selected blocks */
.block-item.selected::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: linear-gradient(45deg, 
        transparent 40%, 
        rgba(0, 123, 255, 0.05) 50%, 
        transparent 60%);
    border-radius: 12px;
    animation: particle-shimmer 4s infinite linear;
    pointer-events: none;
    z-index: -1;
}

/* Smooth entrance animation for new blocks */
.block-item.entering {
    animation: block-enter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    transform: scale(0) translateY(20px);
    opacity: 0;
}

/* Active/touch feedback */
.block-item:active {
    transform: scale(0.95) translateY(0px);
    transition: transform 0.1s ease;
}

/* Subtle block animations */
@keyframes block-selected-pulse {
    0% { 
        box-shadow: 
            0 6px 20px rgba(0, 0, 0, 0.15),
            0 0 15px rgba(0, 123, 255, 0.25);
    }
    50% { 
        box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.18),
            0 0 20px rgba(0, 123, 255, 0.35);
    }
    100% { 
        box-shadow: 
            0 6px 20px rgba(0, 0, 0, 0.15),
            0 0 15px rgba(0, 123, 255, 0.25);
    }
}

@keyframes particle-shimmer {
    0% { 
        background-position: -100% 0;
        opacity: 0.5;
    }
    50% {
        opacity: 0.8;
    }
    100% { 
        background-position: 200% 0;
        opacity: 0.5;
    }
}

@keyframes block-enter {
    0% {
        transform: scale(0) translateY(20px) rotate(-10deg);
        opacity: 0;
    }
    60% {
        transform: scale(1.1) translateY(-5px) rotate(2deg);
        opacity: 0.8;
    }
    100% {
        transform: scale(1) translateY(0) rotate(0deg);
        opacity: 1;
    }
}

/* Particle burst animation for selection effects */
@keyframes particle-burst {
    0% {
        transform: translate(0, 0) scale(1);
        opacity: 1;
    }
    100% {
        transform: translate(
            calc(cos(var(--particle-angle, 0deg)) * 30px),
            calc(sin(var(--particle-angle, 0deg)) * 30px)
        ) scale(0);
        opacity: 0;
    }
}

/* Animation speed control */
:root {
    --animation-speed-multiplier: 1.0;
}

/* Animation preference overrides */
.no-hover-effects .block-item:hover {
    transform: scale(1) translateY(0px) !important;
    box-shadow: none !important;
    background: transparent !important;
    border-color: var(--primary-color) !important;
}

.no-selection-glow .block-item.selected {
    animation: none !important;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3) !important;
}

.no-selection-glow .block-item.selected::before {
    display: none !important;
}

.no-entrance-animations .block-item.entering {
    animation: none !important;
    transform: none !important;
    opacity: 1 !important;
}

.no-particle-effects .selection-particle {
    display: none !important;
}

/* Apply animation speed multiplier to all block animations */
.block-item {
    transition-duration: calc(0.3s * var(--animation-speed-multiplier));
}

.block-item.selected {
    animation-duration: calc(2s * var(--animation-speed-multiplier));
}

.block-item.entering {
    animation-duration: calc(0.6s * var(--animation-speed-multiplier));
}

.block-item.selected::before {
    animation-duration: calc(3s * var(--animation-speed-multiplier));
}

/* Legacy pulse animation for compatibility */
@keyframes pulse {
    0% { box-shadow: 0 12px 35px rgba(0, 123, 255, 0.4); }
    50% { box-shadow: 0 12px 35px rgba(0, 123, 255, 0.6); }
    100% { box-shadow: 0 12px 35px rgba(0, 123, 255, 0.4); }
}

/* Wild block styles */
.block-item.magic-block {
    position: relative;
    background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(255, 142, 142, 0.1) 100%);
    border: 2px solid #ff6b6b !important;
    animation: wildBlockGlow 2s ease-in-out infinite;
}

.block-item.magic-block::before {
    content: '🔮';
    position: absolute;
    top: -5px;
    right: -5px;
    font-size: 1rem;
    z-index: 10;
    animation: wildIconPulse 1.5s ease-in-out infinite;
}

.block-item.magic-block:hover {
    transform: scale(1.08) translateY(-2px);
    border-color: #ff4444 !important;
    background: radial-gradient(circle at center, rgba(255, 107, 107, 0.15) 0%, transparent 70%);
    box-shadow: 
        0 6px 20px rgba(255, 107, 107, 0.3),
        0 0 15px rgba(255, 107, 107, 0.4);
}

.block-item.magic-block.selected {
    border-color: #ff4444 !important;
    background: radial-gradient(circle at center, rgba(255, 107, 107, 0.2) 0%, transparent 70%);
    box-shadow: 
        0 8px 25px rgba(255, 107, 107, 0.4),
        0 0 20px rgba(255, 107, 107, 0.5);
    animation: wildBlockSelected 2s ease-in-out infinite;
}

@keyframes wildBlockGlow {
    0%, 100% { 
        box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
    }
    50% { 
        box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
    }
}

@keyframes wildIconPulse {
    0%, 100% { 
        transform: scale(1);
        opacity: 1;
    }
    50% { 
        transform: scale(1.2);
        opacity: 0.8;
    }
}

/* Magic block feedback animations */
@keyframes magicActivation {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0.5); 
    }
    20% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1.2); 
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -100px) scale(0.8); 
    }
}

@keyframes magicExplanation {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0.8); 
    }
    15% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    85% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -80px) scale(0.9); 
    }
}

@keyframes magicStandby {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0.9); 
    }
    25% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    75% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -70px) scale(0.8); 
    }
}

/* Magic block feedback styling */
.magic-block-activation .magic-icon {
    font-size: 1.5rem;
    margin-bottom: 0.2rem;
    animation: pulse 0.5s ease-in-out infinite alternate;
}

.magic-block-activation .magic-text {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.1rem;
}

.magic-block-activation .magic-subtext {
    font-size: 0.7rem;
    opacity: 0.8;
}

.magic-block-explanation .magic-clear-title {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 0.3rem;
}

.magic-block-explanation .magic-clear-details {
    font-size: 0.8rem;
    margin-bottom: 0.2rem;
    opacity: 0.9;
}

.magic-block-explanation .magic-clear-bonus {
    font-size: 0.9rem;
    font-weight: 700;
    color: #00ff88;
    text-shadow: 0 0 8px #00ff88;
}

.magic-block-standby .magic-standby-text {
    font-size: 0.8rem;
    font-weight: 600;
    margin-bottom: 0.1rem;
}

.magic-block-standby .magic-standby-subtext {
    font-size: 0.6rem;
    opacity: 0.8;
}

/* Additional magic block type animations */
@keyframes bombExplosion {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0.3); 
    }
    15% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1.3); 
    }
    30% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    85% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -100px) scale(0.7); 
    }
}

@keyframes lightningStrike {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -150%) scale(0.5); 
        filter: brightness(3);
    }
    10% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1.2); 
        filter: brightness(2);
    }
    20% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
        filter: brightness(1.5);
    }
    80% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
        filter: brightness(1);
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -120px) scale(0.6); 
        filter: brightness(0.5);
    }
}

@keyframes ghostPhase {
    0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0.8); 
        filter: blur(5px);
    }
    20% { 
        opacity: 0.8; 
        transform: translate(-50%, -50%) scale(1.1); 
        filter: blur(2px);
    }
    40% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1); 
        filter: blur(0px);
    }
    60% { 
        opacity: 0.7; 
        transform: translate(-50%, -50%) scale(1); 
        filter: blur(0px);
    }
    80% { 
        opacity: 0.5; 
        transform: translate(-50%, -80px) scale(0.9); 
        filter: blur(3px);
    }
    100% { 
        opacity: 0; 
        transform: translate(-50%, -120px) scale(0.7); 
        filter: blur(5px);
    }
}

/* Bomb explosion styling */
.bomb-explosion .bomb-icon {
    font-size: 2rem;
    margin-bottom: 0.3rem;
    animation: pulse 0.3s ease-in-out infinite alternate;
}

.bomb-explosion .bomb-text {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.2rem;
}

.bomb-explosion .bomb-details {
    font-size: 0.8rem;
    margin-bottom: 0.2rem;
    opacity: 0.9;
}

.bomb-explosion .bomb-bonus {
    font-size: 0.9rem;
    font-weight: 700;
    color: #00ff88;
    text-shadow: 0 0 8px #00ff88;
}

@keyframes wildBlockSelected {
    0%, 100% { 
        box-shadow: 
            0 8px 25px rgba(255, 107, 107, 0.4),
            0 0 20px rgba(255, 107, 107, 0.5);
    }
    50% { 
        box-shadow: 
            0 10px 30px rgba(255, 107, 107, 0.6),
            0 0 25px rgba(255, 107, 107, 0.7);
    }
}

/* Petrification states for blocks */
.block-item.petrified {
    filter: grayscale(100%) brightness(0.6);
    position: relative;
    cursor: not-allowed;
    pointer-events: none;
}

.block-item.petrified::before {
    content: '❄';
    position: absolute;
    top: 5px;
    right: 5px;
    font-size: 1.2rem;
    text-shadow: 0 0 3px rgba(150, 200, 255, 0.8);
    z-index: 10;
    animation: frozenPulse 2s ease-in-out infinite;
}

@keyframes frozenPulse {
    0%, 100% { opacity: 0.7; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.1); }
}

.block-item.warning-7s {
    animation: warning7sFlash 1s ease-in-out infinite;
}

@keyframes warning7sFlash {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.block-item.warning-3s {
    animation: warning3sFlash 0.3s ease-in-out infinite;
    border-color: #ff6b35 !important;
}

@keyframes warning3sFlash {
    0%, 100% { 
        opacity: 1; 
        box-shadow: 0 0 0 rgba(255, 107, 53, 0);
    }
    50% { 
        opacity: 0.6; 
        box-shadow: 0 0 15px rgba(255, 107, 53, 0.8);
    }
}

    .block-preview {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0;
    min-height: 40px;
    width: auto; /* Let it size based on content */
    height: auto; /* Let it size based on content */
    flex-shrink: 0; /* Don't shrink the preview */
}

    .block-preview canvas {
    border: none;
    border-radius: 4px;
    display: block;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain; /* Maintain aspect ratio */
}

/* Block info and rotate button styles removed - using tooltips and double-click instead */

/* Game layout with palette */
.game-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
}

.game-area {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    align-items: center;
    width: 100%;
}

.game-board-container {
    flex-shrink: 0;
}

/* PWA Styles */
.install-btn {
    animation: pulse 2s infinite;
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
    color: white !important;
    border: none !important;
    box-shadow: 0 2px 8px rgba(40, 167, 69, 0.25) !important;
}

.install-btn:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea085 100%) !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.35) !important;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.update-notification {
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.offline-indicator {
    transition: transform 0.3s ease;
}

/* Responsive design */
@media (max-width: 768px) {
    .header {
        padding: 0.825rem 1rem;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        gap: 0.5rem;
    }
    .utility-bar {
        grid-template-columns: 1fr 1fr 1fr 1fr;
        padding: 0.2rem 0.6rem;
        gap: 0.3rem;
        min-height: 1.5rem;
    }
    
    .utility-bar.has-content {
        padding: 0.4rem 0.6rem;
        min-height: 2.5rem;
    }
    
    .utility-slot {
        min-height: 2rem;
    }
    
    .personal-bests {
        font-size: 0.75rem;
        gap: 0.5rem;
        padding: 0.3rem;
    }
    
    .timer {
        min-width: 60px;
        padding: 0.3rem;
    }
    
    .timer-value {
        font-size: 1rem;
        padding: 0.2rem 0.4rem;
    }
    
    .speed-timer {
        min-width: 50px;
        padding: 0.3rem 0.4rem;
    }
    
    .hint-controls {
        padding: 0.3rem;
    }
    
    .logo-container {
        gap: 0.75rem;
    }
    
    .game-controls {
        gap: 0.4rem;
    }
    
    .header h1 {
        font-size: 1.5rem;
    }
    
    .controls {
        gap: 0.25rem;
        flex-wrap: wrap;
        align-items: center; /* Ensure all controls are vertically aligned */
    }
    
    .main {
        padding: 1rem 0.5rem 0.5rem 0.5rem;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: calc(100vh - 180px); /* Account for header and score bar height */
    }
    
    .game-container {
        width: 100%;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
    }
    
    .game-area {
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
    }
    
    .game-board-container {
        width: 90vw;
        height: 90vw;
        max-width: 90vw;
        max-height: 90vw;
        margin: 0 auto;
        order: 1; /* Game board first */
    }
    
    #game-board {
        width: 100%;
        height: 100%;
        max-width: 90vw;
        max-height: 90vw;
    }
    
    .footer {
        display: none; /* Hide explanation text on mobile */
    }
    
    .game-info {
        flex-direction: row;
        gap: 0.5rem;
        padding: 0.4rem 0.6rem;
        flex-wrap: nowrap;
        background: linear-gradient(135deg, var(--header-bg) 0%, var(--cell-bg) 100%);
        border-radius: 0;
        border: none;
        border-bottom: 1px solid var(--border-color);
        min-height: 45px; /* Increased height to accommodate text */
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .game-info > div {
        min-width: 60px;
        padding: 0.4rem 0.4rem;
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        overflow: visible;
        min-height: 35px;
    }
    
    .game-info span:first-child {
        font-size: 0.825rem; /* 50% increase from 0.55rem */
        line-height: 1;
        margin-bottom: 0.1rem;
        font-weight: 600;
        white-space: nowrap;
        max-width: 100%;
        opacity: 0.95;
    }
    
    .game-info span:last-child {
        font-size: 1.65rem; /* 50% increase from 1.1rem */
        line-height: 1.1;
        font-weight: 900;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        white-space: nowrap;
        max-width: 100%;
        letter-spacing: 0.3px;
    }
    
    .blocks-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.6rem; /* Increased gap for larger blocks */
        width: 100%;
        max-width: 450px; /* Match game board width */
        padding: 0.5rem;
    }
    
    .block-item {
        min-width: 0;
        padding: 0.4rem; /* Increased padding for better touch targets */
        font-size: 0.75rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
        text-align: center;
        min-width: 70px; /* Increased from 50px */
        min-height: 70px; /* Increased from 50px */
        width: auto; /* Let it size naturally */
        height: auto; /* Let it size naturally */
    }
    
    .block-item .block-shape {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex: 1;
        margin: 0;
    }
    
    .block-palette {
        padding: 0.5rem;
        margin: 0;
        width: 100%;
        max-width: 450px; /* Match game board width */
        min-height: 115px; /* Increased height for magnified selected blocks */
        height: 115px;
        order: 2; /* After game board */
    }
    
    .block-palette h3 {
        display: none; /* Hide "Available Blocks" text on mobile */
    }
    
    .rotate-selected-btn {
        position: static;
        transform: none;
        margin: 0.5rem auto 0 auto;
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
        display: block;
    }
    
    .rotate-selected-btn:hover:not(.disabled) {
        transform: translateY(-2px) scale(1.1);
    }
    
    .rotate-selected-btn:active:not(.disabled) {
        transform: scale(0.95);
    }
    
    .btn {
        padding: 0.4rem 0.6rem;
        font-size: 0.7rem;
        min-width: auto;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.25rem;
    }
}

/* Landscape mobile optimization */
@media (max-height: 500px) and (orientation: landscape) {
    .main {
        padding: 0.25rem;
        min-height: auto;
    }
    
    .game-container {
        flex-direction: row;
        gap: 0.5rem;
        max-width: 100%;
        align-items: flex-start;
    }
    
    .game-info {
        order: 0;
        min-height: 30px;
        max-height: 30px;
        padding: 0.2rem 0.4rem;
        flex-shrink: 0;
    }
    
    .game-area {
        flex-direction: column;
        gap: 0.5rem;
        flex: 1;
    }
    
    .game-board-container {
        width: 50vw;
        height: 50vw;
        max-width: 50vw;
        max-height: 50vw;
        order: 1;
    }
    
    .block-palette {
        order: 2;
        min-height: 60px;
        height: 60px;
        padding: 0.3rem;
        flex-shrink: 0;
    }
    
    .game-info > div {
        min-width: 35px;
        padding: 0.1rem 0.15rem;
    }
    
    .game-info span:first-child {
        font-size: 0.675rem; /* 50% increase from 0.45rem */
    }
    
    .game-info span:last-child {
        font-size: 0.9rem; /* 50% increase from 0.6rem */
    }
}

@media (max-width: 480px) {
    .header {
        padding: 0.55rem 0.75rem;
    }
    .utility-bar {
        padding: 0.15rem 0.5rem;
        gap: 0.2rem;
        min-height: 1.2rem;
    }
    
    .utility-bar.has-content {
        padding: 0.3rem 0.5rem;
        min-height: 2rem;
    }
    
    .utility-slot {
        min-height: 1.5rem;
    }
    
    .personal-bests {
        font-size: 0.7rem;
        gap: 0.3rem;
        padding: 0.2rem;
    }
    
    .timer {
        min-width: 50px;
        padding: 0.2rem;
    }
    
    .timer-value {
        font-size: 0.9rem;
        padding: 0.15rem 0.3rem;
    }
    
    .speed-timer {
        min-width: 45px;
        padding: 0.2rem 0.3rem;
        font-size: 0.7rem;
    }
    
    .hint-controls {
        padding: 0.2rem;
    }
    
    .btn-hint {
        font-size: 0.7rem;
        padding: 0.3rem 0.6rem;
    }
    
    .logo-container {
        gap: 0.5rem;
    }
    
    .game-controls {
        gap: 0.3rem;
    }
    
    .controls {
        gap: 0.2rem;
    }
    
    .btn {
        padding: 0.3rem 0.4rem;
        font-size: 0.65rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.2rem;
    }
    
    .main {
        padding: 1rem 0.25rem 0.25rem 0.25rem;
        min-height: calc(100vh - 160px);
    }
    
    .game-container {
        max-width: 350px;
        gap: 1rem;
    }
    
    .game-board-container {
        width: 90vw;
        height: 90vw;
        max-width: 90vw;
        max-height: 90vw;
        margin: 0 auto;
    }
    
    #game-board {
        width: 100%;
        height: 100%;
        max-width: 90vw;
        max-height: 90vw;
    }
    
    .game-area {
        gap: 1rem;
    }
    
    .game-info {
        flex-direction: row;
        gap: 0.3rem;
        padding: 0.3rem 0.4rem;
        min-height: 38px; /* Increased height to accommodate text */
        background: linear-gradient(135deg, var(--header-bg) 0%, var(--cell-bg) 100%);
        border-radius: 0;
        border: none;
        border-bottom: 1px solid var(--border-color);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .game-info > div {
        min-width: 45px;
        padding: 0.2rem 0.25rem;
        box-sizing: border-box;
        overflow: visible;
        min-height: 30px;
    }
    
    .game-info span:first-child {
        font-size: 0.675rem; /* 50% increase from 0.45rem */
        line-height: 1;
        font-weight: 600;
        white-space: nowrap;
        max-width: 100%;
        opacity: 0.95;
    }
    
    .game-info span:last-child {
        font-size: 1.2rem; /* 50% increase from 0.8rem */
        line-height: 1.1;
        font-weight: 900;
        text-shadow: 0 2px 3px rgba(0, 0, 0, 0.4);
        white-space: nowrap;
        max-width: 100%;
        letter-spacing: 0.2px;
    }
    
    .blocks-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.3rem;
        max-width: 450px; /* Match game board width */
        padding: 0.4rem;
    }
    
    .block-item {
        padding: 0.3rem; /* Increased padding for better touch targets */
        font-size: 0.7rem;
        width: auto;
        max-width: none;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        min-width: 60px; /* Increased from 45px */
        min-height: 60px; /* Increased from 45px */
        height: auto; /* Let it size naturally */
    }
    
    .block-palette {
        padding: 0.4rem;
        max-width: 450px; /* Match game board width */
        min-height: 105px; /* Increased height for magnified selected blocks */
        height: 105px;
    }
    
    .rotate-selected-btn {
        width: 35px;
        height: 35px;
        font-size: 1rem;
        margin: 0.3rem auto 0 auto;
    }
    
    /* Mobile Settings Modal */
    .settings-section {
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
    }
    
    .theme-options {
        justify-content: center;
        gap: 0.75rem;
    }
    
    .theme-option {
        min-width: 70px;
        padding: 0.75rem;
    }
    
    .theme-preview {
        width: 32px;
        height: 32px;
    }
    
    .settings-section .difficulty-options {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
    .settings-section .difficulty-option {
        padding: 0.75rem;
    }
    
    .settings-section .difficulty-header h4 {
        font-size: 1rem;
    }
    
    .settings-section .difficulty-option p {
        font-size: 0.85rem;
    }
    
    #install-button-container .install-btn {
        max-width: 100%;
        font-size: 0.9rem;
        padding: 0.75rem 1rem;
    }
}

/* Modal Styles */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: var(--card-bg);
    border-radius: 15px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    border: 1px solid var(--border-color);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
    background: linear-gradient(135deg, var(--header-bg) 0%, var(--primary-color) 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    border-radius: 15px 15px 0 0;
}

.modal-header h2 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
}

.close-btn {
    background: none;
    border: none;
    font-size: 2rem;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s;
}

.close-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

.modal-body {
    padding: 1.5rem;
}

/* High Scores Styles */
.score-item {
    display: flex;
    align-items: center;
    padding: 0.75rem;
    margin-bottom: 0.5rem;
    background: var(--bg-color);
    border-radius: 8px;
    border: 1px solid var(--border-color);
    transition: transform 0.2s, box-shadow 0.2s;
}

.score-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.score-item:first-child {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    color: #333;
    font-weight: 600;
}

.score-item:nth-child(2) {
    background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
    color: #333;
}

.score-item:nth-child(3) {
    background: linear-gradient(135deg, #cd7f32 0%, #daa520 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.score-item:nth-child(4) {
    background: linear-gradient(135deg, #8b4513 0%, #a0522d 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.score-item:nth-child(5) {
    background: linear-gradient(135deg, #654321 0%, #8b4513 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.rank {
    font-weight: bold;
    font-size: 1.1rem;
    margin-right: 1rem;
    min-width: 30px;
}

.score-value {
    font-size: 1.2rem;
    font-weight: 600;
    margin-right: 1rem;
    min-width: 80px;
}

.score-details {
    font-size: 0.9rem;
    color: #333;
    flex: 1;
    font-weight: 500;
}

/* Ensure score details have good contrast on all colored backgrounds */
.score-item:first-child .score-details,
.score-item:nth-child(2) .score-details {
    color: #333;
    font-weight: 600;
}

.score-item:nth-child(3) .score-details,
.score-item:nth-child(4) .score-details,
.score-item:nth-child(5) .score-details {
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    font-weight: 500;
}

/* Statistics Styles */
.statistics {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border-color);
}

.statistics h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.2rem;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid var(--border-color);
}

.stat-item:last-child {
    border-bottom: none;
}

.stat-label {
    font-weight: 500;
    color: var(--text-color);
}

.stat-value {
    font-weight: 600;
    color: var(--primary-color);
    font-size: 1.1rem;
}

/* Responsive Modal */
@media (max-width: 768px) {
    .modal {
        padding: 0.5rem;
    }
    
    .modal-content {
        width: 100%;
        max-width: 100%;
        margin: 0;
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .modal-header {
        padding: 1rem;
        position: sticky;
        top: 0;
        background: var(--card-bg);
        border-bottom: 1px solid var(--border-color);
        z-index: 10;
    }
    
    .modal-body {
        padding: 1rem;
    }
    
    .score-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .rank, .score-value {
        margin-right: 0;
        min-width: auto;
    }
}

@media (max-width: 480px) {
    .modal {
        padding: 0.25rem;
    }
    
    .modal-content {
        max-height: 95vh;
    }
    
    .modal-header {
        padding: 0.75rem;
    }
    
    .modal-header h2 {
        font-size: 1.3rem;
    }
    
    .modal-body {
        padding: 0.75rem;
    }
}

/* Difficulty Modal Styles */
.difficulty-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.difficulty-option {
    border: 2px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    background: var(--card-bg);
    color: var(--text-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.difficulty-option:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: var(--primary-color);
}

.difficulty-option.selected {
    border-color: var(--primary-color);
    background: var(--primary-color);
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
}

/* Override for light theme to ensure readability */
[data-theme="light"] .difficulty-option.selected,
body.light-theme .difficulty-option.selected,
html.light-theme .difficulty-option.selected {
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
}

.difficulty-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.difficulty-header h3 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 600;
}

.difficulty-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.difficulty-badge.easy {
    background: linear-gradient(135deg, #2e7d32 0%, #388e3c 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    border: 1px solid #1b5e20;
    box-shadow: 0 2px 6px rgba(46, 125, 50, 0.3);
}

.difficulty-badge.normal {
    background: #007bff;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.difficulty-badge.hard {
    background: #ffc107;
    color: #333;
}

.difficulty-badge.expert {
    background: #dc3545;
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.difficulty-option p {
    margin: 0.5rem 0 1rem 0;
    font-style: italic;
    opacity: 0.8;
}

.difficulty-option ul {
    margin: 0;
    padding-left: 1.2rem;
    list-style: none;
}

.difficulty-option li {
    position: relative;
    margin-bottom: 0.3rem;
    font-size: 0.9rem;
}

.difficulty-option li::before {
    content: "✓";
    position: absolute;
    left: -1.2rem;
    color: var(--primary-color);
    font-weight: bold;
}

.difficulty-option.selected li::before {
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.difficulty-option.selected h4,
.difficulty-option.selected p {
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
}

.difficulty-settings {
    border-top: 1px solid var(--border-color);
    padding-top: 1.5rem;
}

.difficulty-settings h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
}

.setting-item {
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    transition: all 0.2s ease;
}

.setting-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.setting-item label {
    display: flex;
    align-items: center;
    cursor: pointer;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: var(--text-color);
}

.setting-description {
    margin: 0;
    margin-left: 2rem;
    color: var(--text-muted);
    font-size: 0.9rem;
    line-height: 1.4;
    font-style: italic;
}

/* Settings Modal Styles */
.settings-section {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--border-color);
}

.settings-section:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

/* Settings Section Container - for flattened structure */
.settings-section-container {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.settings-section-container h3 {
    margin: 0 0 1rem 0;
    color: var(--text-color);
    font-size: 1.2rem;
    font-weight: 600;
    text-align: center;
}

.settings-section h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.2rem;
    font-weight: 600;
}

.theme-options {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.theme-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: 12px;
    background: var(--card-bg);
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 80px;
}

.theme-option:hover {
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.theme-option.selected {
    border-color: var(--primary-color);
    background: var(--primary-color);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

/* Override for light theme to ensure readability */
[data-theme="light"] .theme-option.selected,
body.light-theme .theme-option.selected,
html.light-theme .theme-option.selected {
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
}

/* Enhanced selected state for wood theme - more prominent visibility */
[data-theme="wood"] .theme-option.selected,
body.wood-theme .theme-option.selected,
html.wood-theme .theme-option.selected {
    border-color: #a1887f !important;
    background: linear-gradient(135deg, #8d6e63 0%, #a1887f 100%) !important;
    color: #f5f1e8 !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8) !important;
    box-shadow: 0 6px 16px rgba(141, 110, 99, 0.4), 0 0 0 3px rgba(161, 136, 127, 0.3) !important;
    transform: translateY(-3px) !important;
}

/* Enhanced hover state for wood theme */
[data-theme="wood"] .theme-option:hover,
body.wood-theme .theme-option:hover,
html.wood-theme .theme-option:hover {
    border-color: #a1887f !important;
    box-shadow: 0 4px 12px rgba(141, 110, 99, 0.3) !important;
}

/* Navigation buttons container for settings page */
.navigation-buttons {
    margin-top: 1.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
}

.navigation-buttons .back-button {
    /* Use same sizing as other nav-items but override specific styling */
    display: inline-block !important;
    padding: 0.75rem 1.5rem !important;
    font-weight: 600 !important;
    font-size: 0.9rem !important;
    text-decoration: none !important;
    border-radius: 12px !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
    border: 1px solid var(--border-color) !important;
    position: relative !important;
    overflow: hidden !important;
    transition: all 0.3s ease !important;
    text-align: center;
    min-height: 44px;
    min-width: 44px;
    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%) !important;
    color: white !important;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2) !important;
    touch-action: manipulation !important;
}

.navigation-buttons .back-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.navigation-buttons .back-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    color: white !important;
    text-decoration: none;
}

.navigation-buttons .back-button:hover::before {
    left: 100%;
}

.navigation-buttons .back-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

@media (max-width: 768px) {
    .navigation-buttons {
        flex-direction: row;
        gap: 0.5rem;
        justify-content: center;
    }
    
    .navigation-buttons .back-button {
        width: auto;
        min-width: 44px;
        flex: 0 1 auto;
    }
}

.theme-preview {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    border: 2px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.wood-preview {
    background: linear-gradient(135deg, #8d6e63 0%, #a1887f 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.light-preview {
    background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
    color: #333;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
}

.dark-preview {
    background: linear-gradient(135deg, #424242 0%, #616161 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.settings-section .difficulty-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.settings-section .difficulty-option {
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: 12px;
    background: var(--card-bg);
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: left;
}

.settings-section .difficulty-option:hover {
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.settings-section .difficulty-option.selected {
    border-color: var(--primary-color);
    background: var(--primary-color);
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
}

/* Override for light theme to ensure readability */
[data-theme="light"] .settings-section .difficulty-option.selected,
body.light-theme .settings-section .difficulty-option.selected,
html.light-theme .settings-section .difficulty-option.selected {
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
}

.settings-section .difficulty-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.settings-section .difficulty-header h4 {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
}

.settings-section .difficulty-option p {
    margin: 0;
    font-size: 0.9rem;
    opacity: 0.8;
}

.settings-section .difficulty-option.selected p {
    opacity: 1;
    color: white !important;
}

.settings-section .difficulty-option.selected h4 {
    color: white !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7) !important;
}

.setting-item input[type="checkbox"],
.setting-item input[type="radio"] {
    margin-right: 0.75rem;
    width: 18px;
    height: 18px;
    accent-color: var(--primary-color);
}

/* Combo Display Settings */
.combo-display-settings {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.combo-display-settings h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.1rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.5rem;
    text-align: center;
}

/* Game Modes Settings */
.game-modes-settings {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.game-modes-settings h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.1rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.5rem;
}

.game-modes-settings h4 {
    margin: 1.5rem 0 0.5rem 0;
    color: var(--text-color);
    font-size: 1rem;
    font-weight: 600;
}

.game-mode-item {
    background: rgba(var(--primary-color-rgb), 0.05);
    border: 1px solid rgba(var(--primary-color-rgb), 0.2);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    transition: all 0.2s ease;
}

.game-mode-item:hover {
    background: rgba(var(--primary-color-rgb), 0.08);
    border-color: rgba(var(--primary-color-rgb), 0.3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Basic Game Settings */
.basic-game-settings {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.basic-game-settings h3 {
    margin-bottom: 1rem;
    color: var(--text-color);
    font-size: 1.1rem;
    font-weight: 600;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.5rem;
}

.combo-options {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.combo-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    background: var(--bg-color);
    transition: all 0.3s ease;
    flex: 1;
    min-width: 120px;
    text-align: center;
}

.combo-option:hover {
    border-color: var(--primary-color);
    background: var(--cell-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.combo-option input[type="radio"] {
    display: none;
}

.combo-option:has(input:checked) {
    border-color: var(--primary-color);
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
    color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.combo-option:has(input:checked) .combo-label {
    color: white;
    font-weight: 600;
}

.combo-option:has(input:checked) .combo-description {
    color: rgba(255, 255, 255, 0.9);
}

.combo-label {
    font-weight: 600;
    color: var(--text-color);
    transition: color 0.3s ease;
    display: block;
    margin-bottom: 0.5rem;
    font-size: 1rem;
}

.combo-description {
    font-size: 0.85rem;
    color: var(--text-muted);
    font-style: italic;
    display: block;
    line-height: 1.4;
    text-align: center;
}

@media (max-width: 768px) {
    .combo-options,
    .speed-mode-options,
    .animation-speed-options {
        flex-direction: column;
    }
    
    .combo-option,
    .speed-mode-option,
    .animation-speed-option {
        min-width: auto;
        padding: 1.25rem;
    }
    
    .setting-description {
        margin-left: 1.5rem;
        font-size: 0.85rem;
    }
    
    .setting-item {
        padding: 0.75rem;
        margin-bottom: 1rem;
    }
}

/* Install Button in Settings */
#install-button-container {
    margin-top: 1rem;
    text-align: center;
}

#install-button-container .install-btn {
    width: 100%;
    max-width: 200px;
    margin: 0 auto;
    display: none;
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
    color: white !important;
    border: none !important;
    box-shadow: 0 2px 8px rgba(40, 167, 69, 0.25) !important;
}

#install-button-container .install-btn:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea085 100%) !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.35) !important;
}

#install-button-container .install-btn.show {
    display: inline-block;
}

/* Build Info Styles */
.build-info {
    font-size: 0.85rem;
    color: var(--text-muted, #666);
    margin-top: 0.25rem;
    font-family: 'Courier New', monospace;
    opacity: 0.8;
}

/* Responsive Difficulty Modal */
@media (max-width: 768px) {
    .difficulty-options {
        grid-template-columns: 1fr;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }
    
    .difficulty-option {
        padding: 1rem;
        margin-bottom: 0.5rem;
    }
    
    .difficulty-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
    }
    
    .difficulty-header h3 {
        font-size: 1.2rem;
    }
    
    .difficulty-badge {
        align-self: flex-end;
        font-size: 0.7rem;
        padding: 0.2rem 0.6rem;
    }
    
    .difficulty-option p {
        font-size: 0.9rem;
        margin: 0.4rem 0 0.8rem 0;
    }
    
    .difficulty-option li {
        font-size: 0.85rem;
        margin-bottom: 0.25rem;
    }
}

@media (max-width: 480px) {
    .difficulty-options {
        gap: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .difficulty-option {
        padding: 0.75rem;
    }
    
    .difficulty-header h3 {
        font-size: 1.1rem;
    }
    
    .difficulty-option p {
        font-size: 0.85rem;
    }
    
    .difficulty-option li {
        font-size: 0.8rem;
    }
}

/* Drag and drop styles for mobile */
.drag-block-element {
    position: fixed;
    pointer-events: none;
    z-index: 1000;
    opacity: 0.8;
    transform: translate(-50%, -50%);
    transition: none;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.drag-block-element canvas {
    border-radius: 4px;
    border: 2px solid rgba(255, 255, 255, 0.3);
}

/* Enhanced block palette for touch devices */
@media (max-width: 768px) {
    .block-item {
        touch-action: manipulation;
        user-select: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
        min-height: 44px; /* Minimum touch target size */
        min-width: 44px;
    }
    
    /* Ensure all interactive elements have proper touch targets */
    button, .nav-item, .theme-option, .difficulty-option {
        min-height: 44px;
        min-width: 44px;
        touch-action: manipulation;
    }
    
    /* Back button styling */
    .back-button, .nav-item.back-button {
        display: inline-block !important;
        padding: 0.75rem 1.5rem !important;
        background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%) !important;
        color: white !important;
        text-decoration: none !important;
        border-radius: 12px !important;
        font-weight: 600 !important;
        font-size: 0.9rem !important;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
        border: 1px solid var(--border-color) !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1) !important;
        transition: all 0.3s ease !important;
        position: relative !important;
        overflow: hidden !important;
        min-height: 44px !important;
        min-width: 44px !important;
        touch-action: manipulation !important;
    }
    
    .back-button::before, .nav-item.back-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }
    
    .back-button:hover, .nav-item.back-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        color: white;
        text-decoration: none;
    }
    
    .back-button:hover::before, .nav-item.back-button:hover::before {
        left: 100%;
    }
    
    .back-button:active, .nav-item.back-button:active {
        transform: translateY(0);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    /* General nav-item styling for settings navigation */
    .settings-nav .nav-item:not(.back-button) {
        display: inline-block !important;
        padding: 0.75rem 1.5rem !important;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%) !important;
        color: white !important;
        text-decoration: none !important;
        border-radius: 12px !important;
        font-weight: 600 !important;
        font-size: 0.9rem !important;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
        box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3) !important;
        transition: all 0.3s ease !important;
        position: relative !important;
        overflow: hidden !important;
        min-height: 44px !important;
        min-width: 44px !important;
        touch-action: manipulation !important;
        margin-left: 0.5rem !important;
    }
    
    .settings-nav .nav-item:not(.back-button)::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }
    
    .settings-nav .nav-item:not(.back-button):hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
        color: white;
        text-decoration: none;
    }
    
    .settings-nav .nav-item:not(.back-button):hover::before {
        left: 100%;
    }
    
    .settings-nav .nav-item:not(.back-button):active {
        transform: translateY(0);
        box-shadow: 0 2px 8px rgba(0, 123, 255, 0.3);
    }
    
    .block-item:active {
        transform: scale(0.95);
        transition: transform 0.1s ease;
    }
    
    .difficulty-btn {
        min-width: 70px;
        font-size: 0.8rem;
    }
    
    /* Mobile difficulty theming adjustments */
    .difficulty-btn.easy {
        box-shadow: 0 1px 4px rgba(76, 175, 80, 0.3);
    }
    
    .difficulty-btn.normal {
        box-shadow: 0 1px 4px rgba(33, 150, 243, 0.3);
    }
    
    .difficulty-btn.hard {
        box-shadow: 0 1px 4px rgba(255, 152, 0, 0.3);
    }
    
    .difficulty-btn.expert {
        box-shadow: 0 1px 4px rgba(244, 67, 54, 0.3);
        animation: expert-pulse-mobile 2s infinite;
    }
    
    @keyframes expert-pulse-mobile {
        0%, 100% { 
            box-shadow: 0 1px 4px rgba(244, 67, 54, 0.3);
        }
        50% { 
            box-shadow: 0 1px 6px rgba(244, 67, 54, 0.5);
        }
    }
    
    .new-game-btn {
        min-width: 70px;
        font-size: 0.8rem;
    }
    
    #settings-toggle,
    #game-settings-toggle {
        min-width: 40px; /* Narrower for mobile */
        font-size: 1rem;
        padding: 0.4rem;
    }
}

@media (max-width: 768px) {
    .difficulty-btn {
        min-width: 75px;
        font-size: 0.85rem;
    }
    
    .new-game-btn {
        min-width: 75px;
        font-size: 0.85rem;
    }
    
    #settings-toggle,
    #game-settings-toggle {
        min-width: 45px; /* Narrower for tablet */
        font-size: 1.1rem;
        padding: 0.45rem;
    }
}

/* Share Button Styles */
.share-button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    transition: background-color 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-left: 0.5rem;
}

.share-button:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.share-icon {
    width: 20px;
    height: 20px;
    display: inline-block;
    position: relative;
}

/* Material Design Share Icon (Android) */
.share-icon.material {
    background: currentColor;
    mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z'/%3E%3C/svg%3E") no-repeat center;
    mask-size: contain;
}

/* iOS Share Icon (square with arrow) */
.share-icon.ios {
    background: currentColor;
    mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M3 3h18v18H3V3zm2 2v14h14V5H5zm2 2h10v2H7V7zm0 4h10v2H7v-2zm0 4h7v2H7v-2zm9-4l2-2 2 2v8h-4v-8z'/%3E%3C/svg%3E") no-repeat center;
    mask-size: contain;
}

/* Fallback for other platforms */
.share-icon:not(.material):not(.ios) {
    background: currentColor;
    mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z'/%3E%3C/svg%3E") no-repeat center;
    mask-size: contain;
}

/* PWA Install Button Styles */
.pwa-install-item {
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

/* Reset Statistics Button Styles */
.reset-stats-item {
    margin-top: 0;
    padding-top: 0;
    border-top: none;
    background: transparent;
    border-radius: 0;
    padding: 0;
    margin-left: 0;
    margin-right: 0;
}

.pwa-install-button {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    box-shadow: 0 2px 8px rgba(40, 167, 69, 0.25);
}

.pwa-install-button:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea085 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.35);
}

.pwa-install-button:active {
    transform: translateY(0);
}

.pwa-install-button.installed {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
}

.pwa-install-button.installed:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea085 100%);
}

.install-text {
    font-weight: 600;
}

.install-status {
    font-weight: 700;
    font-size: 0.9rem;
}

.pwa-install-button.installed .install-text {
    display: none;
}

.pwa-install-button.installed .install-status::before {
    content: "✓ ";
    margin-right: 0.25rem;
}

.reset-stats-button {
    background: linear-gradient(135deg, #ff6b35 0%, #e55a2b 100%);
    color: white;
    border: 1px solid #d4491f;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.2);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    position: relative;
    overflow: hidden;
}

.reset-stats-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.reset-stats-button:hover::before {
    left: 100%;
}

.reset-stats-button:hover {
    background: linear-gradient(135deg, #e55a2b 0%, #cc4a1f 100%);
    border-color: #b8401a;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
}

.reset-stats-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(255, 107, 53, 0.4);
}

.reset-text {
    font-weight: 600;
}

/* Clear Cache Button */
.clear-cache-button {
    background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
    color: white;
    border: 1px solid #6a1b9a;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    box-shadow: 0 2px 8px rgba(156, 39, 176, 0.2);
    position: relative;
    overflow: hidden;
}

.clear-cache-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.clear-cache-button:hover::before {
    left: 100%;
}

.clear-cache-button:hover {
    background: linear-gradient(135deg, #7b1fa2 0%, #6a1b9a 100%);
    border-color: #4a148c;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(156, 39, 176, 0.3);
}

.clear-cache-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(156, 39, 176, 0.4);
}

.clear-cache-text {
    font-weight: 600;
}

/* Theme-specific enhancements for reset stats button - removed red glow */

/* Copyright Notice */
.copyright-notice {
    position: static;
    bottom: auto;
    right: auto;
    z-index: 1000;
    pointer-events: none;
    margin: 2rem 0 0;
    text-align: center;
    width: 100%;
}

.copyright-notice p {
    margin: 0;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    font-weight: 400;
    letter-spacing: 0.5px;
}

/* Ensure copyright is visible on different backgrounds */
.copyright-notice p {
    background: rgba(0, 0, 0, 0.2);
    padding: 2px 6px;
    border-radius: 4px;
    backdrop-filter: blur(2px);
}

.copyright-notice a {
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    pointer-events: auto;
    transition: color 0.2s ease;
}

.copyright-notice a:hover {
    color: rgba(255, 255, 255, 1);
    text-decoration: underline;
}

/* Point Breakdown Display */
.point-breakdown {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    color: #fff;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    text-align: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    border: 2px solid var(--primary-color);
    z-index: 1000;
    pointer-events: none;
    line-height: 1.4;
    min-width: 200px;
    backdrop-filter: blur(10px);
    width: auto;
    height: auto;
}

.point-breakdown::before {
    content: '';
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid var(--primary-color);
}

/* Floating Score Animation */
.floating-score {
    position: absolute;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    font-weight: 900;
    text-align: center;
    user-select: none;
    animation: floatUp 1.5s ease-out forwards;
}

@keyframes floatUp {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
    50% {
        transform: translateY(-30px) scale(1.1);
        opacity: 0.8;
    }
    100% {
        transform: translateY(-60px) scale(1.2);
        opacity: 0;
    }
}

/* Piece Timeout States */
.block-item.piece-struggling {
    animation: pieceStruggle 0.8s ease-in-out infinite;
    filter: brightness(1.2) saturate(1.3);
}

.block-item.piece-timed-out {
    filter: grayscale(100%) brightness(0.3) opacity(0.5);
    cursor: not-allowed;
    pointer-events: none;
    position: relative;
    animation: none;
}

.block-item.piece-timed-out::after {
    content: '🔒';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    opacity: 0.8;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
    z-index: 10;
    pointer-events: none;
}

@keyframes pieceStruggle {
    0% {
        transform: rotate(0deg) scale(1);
    }
    25% {
        transform: rotate(-3deg) scale(1.05);
    }
    50% {
        transform: rotate(0deg) scale(1);
    }
    75% {
        transform: rotate(3deg) scale(1.05);
    }
    100% {
        transform: rotate(0deg) scale(1);
    }
}

/* Floating notification for piece timeout */
.floating-piece-timeout {
    position: fixed;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    font-weight: 900;
    text-align: center;
    user-select: none;
    color: #ff4444;
    font-size: 1.5rem;
    text-shadow: 0 0 10px #ff4444, 0 0 20px #ff4444;
    pointer-events: none;
    z-index: 1001;
    animation: floatUpLong 3s ease-out forwards;
    white-space: nowrap;
    padding: 0.5rem 1rem;
    background: rgba(0, 0, 0, 0.7);
    border-radius: 8px;
    border: 2px solid #ff4444;
    box-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
}

@keyframes floatUpLong {
    0% {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 0;
    }
    10% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 1;
    }
    40% {
        transform: translate(-50%, -70px) scale(1.1);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -120px) scale(1);
        opacity: 0;
    }
}

/* Setting Bubbles - Dynamic status indicators */
.setting-bubble {
    display: inline-block;
    font-size: 0.75rem;
    padding: 0.2rem 0.6rem;
    margin-left: auto;
    border-radius: 12px;
    font-weight: 600;
    transition: all 0.3s ease;
    opacity: 0.9;
    position: relative;
    flex-shrink: 0;
}

/* Speed mode and animation speed bubbles in header - no margin-left auto */
.speed-mode-bubble,
.animation-speed-bubble {
    margin-left: 0.5rem;
}

/* Disabled/off state - blends with theme */
.setting-bubble.state-red {
    background: linear-gradient(135deg, var(--secondary-color) 0%, var(--secondary-hover) 100%);
    color: var(--text-color);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    opacity: 0.7;
}

/* Green state (enabled/on) */
.setting-bubble.state-green {
    background: linear-gradient(135deg, #44ff44 0%, #00cc00 100%);
    color: #1a1a1a;
    box-shadow: 0 2px 8px rgba(68, 255, 68, 0.3);
}

/* Orange state (for punishment/warning) */
.setting-bubble.state-orange {
    background: linear-gradient(135deg, #ff9944 0%, #ff7700 100%);
    color: #1a1a1a;
    box-shadow: 0 2px 8px rgba(255, 153, 68, 0.4);
}

/* Yellow state (for difficulty comparisons) */
.setting-bubble.state-yellow {
    background: linear-gradient(135deg, #ffdd44 0%, #ffaa00 100%);
    color: #1a1a1a;
    box-shadow: 0 2px 8px rgba(255, 221, 68, 0.3);
}

/* Difficulty-specific settings - get a gold border to show they're tied to difficulty level */
.setting-bubble.difficulty-specific {
    border: 2px solid #ffd700;
    box-shadow: 0 2px 8px rgba(255, 215, 0, 0.4), inset 0 0 8px rgba(255, 215, 0, 0.2);
}

/* Global settings - get a subtle gray border */
.setting-bubble.global-setting {
    border: 2px solid rgba(128, 128, 128, 0.3);
}

.setting-bubble:hover {
    transform: scale(1.05);
    opacity: 1;
}

/* Add a small indicator tooltip on hover */
.setting-bubble.difficulty-specific::after {
    content: "Per-Difficulty";
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-4px);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 0.3rem 0.5rem;
    border-radius: 4px;
    font-size: 0.65rem;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    z-index: 1000;
}

.setting-bubble.difficulty-specific:hover::after {
    opacity: 1;
}

.setting-bubble.global-setting::after {
    content: "Global";
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-4px);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 0.3rem 0.5rem;
    border-radius: 4px;
    font-size: 0.65rem;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    z-index: 1000;
}

.setting-bubble.global-setting:hover::after {
    opacity: 1;
}
