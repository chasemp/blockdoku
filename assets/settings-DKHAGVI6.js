import"./wood-BFBTfjaZ.js";/* empty css             */import{G as P,C as T,S as D,P as $}from"./sound-manager-D85b1tFB.js";import{b as B}from"./build-info-Dwp5dZmk.js";class M{constructor(){this.storage=new P,this.settings=this.storage.loadSettings(),this.currentTheme=this.settings.theme||"wood",this.currentDifficulty=this.settings.difficulty||"normal",this.pwaInstallManager=null,this.confirmationDialog=new T,this.soundManager=new D,this.init()}init(){this.loadSettings(),this.setupEventListeners(),this.updateUI(),this.updateBuildInfo(),this.initializePWA()}initializePWA(){try{this.pwaInstallManager=new $,console.log("PWA Install Manager initialized in settings")}catch(e){console.error("Failed to initialize PWA Install Manager:",e)}}loadSettings(){this.currentTheme=this.settings.theme||"wood",this.currentDifficulty=this.settings.difficulty||"normal",this.applyTheme(this.currentTheme),this.loadEffectsSettings(),this.updateDifficultyUI()}loadEffectsSettings(){const e=document.getElementById("sound-enabled");e&&(e.checked=this.settings.soundEnabled===!0);const s=document.getElementById("sound-enabled-sounds-section");s&&(s.checked=this.settings.soundEnabled===!0);const n=document.getElementById("animations-enabled");n&&(n.checked=this.settings.animationsEnabled!==!1);const o=document.getElementById("block-hover-effects");o&&(o.checked=this.settings.blockHoverEffects!==!1);const a=document.getElementById("block-selection-glow");a&&(a.checked=this.settings.blockSelectionGlow!==!1);const d=document.getElementById("block-entrance-animations");d&&(d.checked=this.settings.blockEntranceAnimations!==!1);const u=document.getElementById("particle-effects");u&&(u.checked=this.settings.particleEffects!==!1);const i=document.getElementById("animation-speed");i&&(i.value=this.settings.animationSpeed||"normal");const l=document.getElementById("haptic-enabled");l&&(l.checked=this.settings.hapticEnabled!==!1);const m=document.getElementById("enable-hints");m&&(m.checked=this.settings.enableHints===!0);const f=document.getElementById("enable-timer");f&&(f.checked=this.settings.enableTimer===!0);const g=document.getElementById("enable-petrification");g&&(g.checked=this.settings.enablePetrification===!0);const v=document.getElementById("enable-dead-pixels");v&&(v.checked=this.settings.enableDeadPixels===!0);const S=document.getElementById("dead-pixels-intensity"),k=document.getElementById("dead-pixels-intensity-value"),w=document.getElementById("dead-pixels-intensity-container");if(S&&k){const L=this.settings.deadPixelsIntensity||0;S.value=L,k.textContent=L,w&&(w.style.display=this.settings.enableDeadPixels===!0?"block":"none")}const t=document.getElementById("auto-save");t&&(t.checked=this.settings.autoSave!==!1);const r=document.getElementById("show-points");r&&(r.checked=this.settings.showPoints===!0);const p=document.getElementById("show-placement-points");p&&(p.checked=this.settings.showPlacementPoints===!0);const h=document.getElementById("show-high-score");if(h&&(h.checked=this.settings.showHighScore===!0),this.speedModeOrder=["ignored","bonus","punishment"],this.currentSpeedModeIndex=0,document.getElementById("speed-mode-toggle")){const L=this.settings.speedMode||"ignored";this.currentSpeedModeIndex=this.speedModeOrder.indexOf(L),this.currentSpeedModeIndex===-1&&(this.currentSpeedModeIndex=0),this.updateSpeedModeDisplay()}const E=document.getElementById("success-mode-enabled");E&&(E.checked=this.settings.successModeEnabled!==!1);const b=document.getElementById("show-speed-timer");b&&(b.checked=this.settings.showSpeedTimer===!0);const y=document.getElementById("enable-prize-recognition");y&&(y.checked=this.settings.enablePrizeRecognition!==!1);const c=document.getElementById("combo-streak"),x=document.getElementById("combo-cumulative");c&&x&&((this.settings.comboDisplayMode||"cumulative")==="cumulative"?x.checked=!0:c.checked=!0),this.updateAnimationSettingsVisibility()}updateAnimationSettingsVisibility(){const e=document.getElementById("animations-enabled"),s=document.getElementById("animation-settings");e&&s&&(e.checked?(s.style.display="block",s.style.opacity="1"):(s.style.display="none",s.style.opacity="0.5"))}setupEventListeners(){document.querySelectorAll(".nav-item").forEach(t=>{let r=null,p=null,h=!1;const I=c=>{c.preventDefault(),this.showSection(t.dataset.section)},E=()=>{p&&(clearTimeout(p),p=null),h=!1,r=null,t.classList.remove("pressing")},b=c=>{c.preventDefault(),!h&&(h=!0,r=Date.now(),t.classList.add("pressing"),p=setTimeout(()=>{h&&(I(c),E())},750))},y=c=>{h&&(c.preventDefault(),E())};t.addEventListener("mousedown",b),t.addEventListener("mouseup",y),t.addEventListener("mouseleave",y),t.addEventListener("touchstart",b,{passive:!1}),t.addEventListener("touchend",y,{passive:!1}),t.addEventListener("touchcancel",y,{passive:!1}),t.addEventListener("click",c=>{c.preventDefault(),!h&&(!r||Date.now()-r<200)&&I(c)})}),document.querySelectorAll(".theme-option").forEach(t=>{let r=null,p=null,h=!1;const I=c=>{this.selectTheme(c.currentTarget.dataset.theme)},E=()=>{p&&(clearTimeout(p),p=null),h=!1,r=null,t.classList.remove("pressing")},b=c=>{c.preventDefault(),!h&&(h=!0,r=Date.now(),t.classList.add("pressing"),p=setTimeout(()=>{h&&(I(c),E())},750))},y=c=>{h&&(c.preventDefault(),E())};t.addEventListener("mousedown",b),t.addEventListener("mouseup",y),t.addEventListener("mouseleave",y),t.addEventListener("touchstart",b,{passive:!1}),t.addEventListener("touchend",y,{passive:!1}),t.addEventListener("touchcancel",y,{passive:!1}),t.addEventListener("click",c=>{c.preventDefault(),!h&&(!r||Date.now()-r<200)&&I(c)})}),document.querySelectorAll(".difficulty-option").forEach(t=>{let r=null,p=null,h=!1;const I=async c=>{await this.selectDifficulty(c.currentTarget.dataset.difficulty)},E=()=>{p&&(clearTimeout(p),p=null),h=!1,r=null,t.classList.remove("pressing")},b=c=>{c.preventDefault(),!h&&(h=!0,r=Date.now(),t.classList.add("pressing"),p=setTimeout(async()=>{h&&(await I(c),E())},750))},y=c=>{h&&(c.preventDefault(),E())};t.addEventListener("mousedown",b),t.addEventListener("mouseup",y),t.addEventListener("mouseleave",y),t.addEventListener("touchstart",b,{passive:!1}),t.addEventListener("touchend",y,{passive:!1}),t.addEventListener("touchcancel",y,{passive:!1}),t.addEventListener("click",async c=>{c.preventDefault(),!h&&(!r||Date.now()-r<200)&&await I(c)})}),document.getElementById("enable-hints").addEventListener("change",t=>{this.updateSetting("enableHints",t.target.checked)}),document.getElementById("enable-timer").addEventListener("change",t=>{this.updateSetting("enableTimer",t.target.checked)});const e=document.getElementById("enable-petrification");e&&e.addEventListener("change",t=>{this.updateSetting("enablePetrification",t.target.checked)});const s=document.getElementById("enable-dead-pixels");s&&s.addEventListener("change",t=>{this.updateSetting("enableDeadPixels",t.target.checked);const r=document.getElementById("dead-pixels-intensity-container");r&&(r.style.display=t.target.checked?"block":"none")});const n=document.getElementById("dead-pixels-intensity"),o=document.getElementById("dead-pixels-intensity-value");n&&o&&n.addEventListener("input",t=>{const r=parseInt(t.target.value);o.textContent=r,this.updateSetting("deadPixelsIntensity",r)}),document.getElementById("sound-enabled").addEventListener("change",t=>{this.updateSetting("soundEnabled",t.target.checked);const r=document.getElementById("sound-enabled-sounds-section");r&&(r.checked=t.target.checked)});const a=document.getElementById("sound-enabled-sounds-section");a&&a.addEventListener("change",t=>{this.updateSetting("soundEnabled",t.target.checked);const r=document.getElementById("sound-enabled");r&&(r.checked=t.target.checked)}),document.getElementById("animations-enabled").addEventListener("change",t=>{this.updateSetting("animationsEnabled",t.target.checked),this.updateAnimationSettingsVisibility()}),document.getElementById("block-hover-effects").addEventListener("change",t=>{this.updateSetting("blockHoverEffects",t.target.checked)}),document.getElementById("block-selection-glow").addEventListener("change",t=>{this.updateSetting("blockSelectionGlow",t.target.checked)}),document.getElementById("block-entrance-animations").addEventListener("change",t=>{this.updateSetting("blockEntranceAnimations",t.target.checked)}),document.getElementById("particle-effects").addEventListener("change",t=>{this.updateSetting("particleEffects",t.target.checked)}),document.getElementById("animation-speed").addEventListener("change",t=>{this.updateSetting("animationSpeed",t.target.value)}),document.getElementById("auto-save").addEventListener("change",t=>{this.updateSetting("autoSave",t.target.checked)}),document.getElementById("show-points").addEventListener("change",t=>{this.updateSetting("showPoints",t.target.checked),this.updateBlockPointsDisplay()});const d=document.getElementById("show-placement-points");d&&d.addEventListener("change",t=>{this.updateSetting("showPlacementPoints",t.target.checked)});const u=document.getElementById("show-high-score");u&&u.addEventListener("change",t=>{this.updateSetting("showHighScore",t.target.checked)});const i=document.getElementById("speed-mode-toggle");i&&i.addEventListener("click",t=>{t.preventDefault(),this.cycleSpeedMode()});const l=document.getElementById("success-mode-enabled");l&&l.addEventListener("change",t=>{this.updateSetting("successModeEnabled",t.target.checked)});const m=document.getElementById("show-speed-timer");m&&m.addEventListener("change",t=>{this.updateSetting("showSpeedTimer",t.target.checked)});const f=document.getElementById("enable-prize-recognition");f&&f.addEventListener("change",t=>{this.updateSetting("enablePrizeRecognition",t.target.checked)});const g=document.getElementById("combo-streak"),v=document.getElementById("combo-cumulative");g&&v&&(g.addEventListener("change",t=>{t.target.checked&&this.updateSetting("comboDisplayMode","streak")}),v.addEventListener("change",t=>{t.target.checked&&this.updateSetting("comboDisplayMode","cumulative")})),document.getElementById("haptic-enabled").addEventListener("change",t=>{this.updateSetting("hapticEnabled",t.target.checked)});const S=document.getElementById("share-button");S&&S.addEventListener("click",()=>{this.shareGame()});const k=document.getElementById("share-scores-button");k&&k.addEventListener("click",()=>{this.shareHighScores()});const w=document.getElementById("reset-stats");w&&w.addEventListener("click",async()=>{if(await this.confirmationDialog.show("This will permanently delete your game statistics (games played, totals, best score). Your high scores and settings will not be affected. Continue?")){this.storage.clearStatistics();try{this.loadHighScores()}catch{}this.showNotification("Statistics reset")}})}showSection(e){document.querySelectorAll(".nav-item").forEach(s=>{s.classList.remove("active")}),document.querySelector(`[data-section="${e}"]`).classList.add("active"),document.querySelectorAll(".settings-section").forEach(s=>{s.classList.remove("active")}),document.getElementById(`${e}-section`).classList.add("active"),e==="scores"?this.loadHighScores():e==="sounds"&&this.loadSoundCustomization()}loadSoundCustomization(){const e=document.getElementById("sound-customization-container");if(!e)return;this.soundManager.setEnabled(!0);const s=this.soundManager.getGroupedSoundEffects(),n=this.soundManager.getAvailablePresets(),o=this.soundManager.getGroupedSoundSettings();let a="";for(const[i,l]of Object.entries(s)){const m=o[i]||"default",f=m==="mixed",g=m==="none";a+=`
                <div class="sound-group-item">
                    <div class="sound-group-info">
                        <h4>${l.name}</h4>
                        <p>${l.description}</p>
                        <div class="sound-group-details">
                            <small>Includes: ${l.sounds.length} sound${l.sounds.length!==1?"s":""}</small>
                            ${f?'<small class="mixed-indicator">‚ö†Ô∏è Mixed presets</small>':""}
                        </div>
                    </div>
                    <div class="sound-group-controls">
                        <select class="sound-group-preset-select" data-group="${i}">
                            <option value="default" ${m==="default"?"selected":""}>Default</option>
                            <option value="none" ${m==="none"?"selected":""}>None</option>
                            ${Object.entries(n).map(([v,S])=>v!=="default"?`<option value="${v}" ${m===v?"selected":""}>${S.name}</option>`:"").join("")}
                        </select>
                        <button class="sound-group-preview-btn" data-group="${i}">
                            üîä Preview
                        </button>
                        <button class="sound-group-mute-btn ${g?"muted":""}" data-group="${i}" title="${g?"Unmute":"Mute"}">
                            ${g?"üîá":"üîä"}
                        </button>
                    </div>
                </div>
            `}a+=`
            <div class="sound-group-actions">
                <button class="sound-reset-all-btn" id="reset-all-sounds">
                    Reset All to Default
                </button>
                <button class="sound-advanced-btn" id="show-advanced-sounds">
                    Advanced Individual Settings
                </button>
            </div>
        `,e.innerHTML=a,e.querySelectorAll(".sound-group-preset-select").forEach(i=>{i.addEventListener("change",l=>{const m=l.target.dataset.group,f=l.target.value;this.soundManager.setGroupedSoundSettings(m,f);const g=l.target.parentElement.querySelector(".sound-group-mute-btn");g&&(f==="none"?(g.classList.add("muted"),g.textContent="üîá",g.title="Unmute"):(g.classList.remove("muted"),g.textContent="üîä",g.title="Mute"));const v=l.target.closest(".sound-group-item"),S=v.querySelector(".mixed-indicator");if(f==="mixed"){if(!S){const k=v.querySelector(".sound-group-details");k.innerHTML+='<small class="mixed-indicator">‚ö†Ô∏è Mixed presets</small>'}}else S&&S.remove()})}),e.querySelectorAll(".sound-group-preview-btn").forEach(i=>{i.addEventListener("click",l=>{const m=l.currentTarget.dataset.group;if(l.currentTarget.parentElement.querySelector(".sound-group-preset-select").value==="none"){const v=i.textContent;i.textContent="üîá Silent",i.style.opacity="0.6",setTimeout(()=>{i.textContent=v,i.style.opacity="1"},500)}else this.soundManager.previewGroupedSound(m)})}),e.querySelectorAll(".sound-group-mute-btn").forEach(i=>{i.addEventListener("click",l=>{const m=l.currentTarget.dataset.group,f=l.currentTarget.parentElement.querySelector(".sound-group-preset-select");f.value==="none"?(f.value="default",this.soundManager.setGroupedSoundSettings(m,"default"),i.classList.remove("muted"),i.textContent="üîä",i.title="Mute"):(f.value="none",this.soundManager.setGroupedSoundSettings(m,"none"),i.classList.add("muted"),i.textContent="üîá",i.title="Unmute")})});const d=document.getElementById("reset-all-sounds");d&&d.addEventListener("click",async()=>{await this.confirmationDialog.show("Reset all sound effects to their default sounds?")&&this.resetAllSounds()});const u=document.getElementById("show-advanced-sounds");u&&u.addEventListener("click",()=>{this.toggleAdvancedSoundSettings()})}resetAllSounds(){this.soundManager.customSoundMappings={},this.soundManager.saveSoundMappings(),this.soundManager.createSounds(),this.loadSoundCustomization(),this.showNotification("All sounds reset to default")}toggleAdvancedSoundSettings(){const e=document.getElementById("sound-customization-container");if(!e)return;e.querySelector(".sound-effect-item")?this.loadSoundCustomization():this.loadAdvancedSoundCustomization()}loadAdvancedSoundCustomization(){const e=document.getElementById("sound-customization-container");if(!e)return;this.soundManager.setEnabled(!0);const s=this.soundManager.getSoundEffects(),n=this.soundManager.getAvailablePresets(),o=this.soundManager.customSoundMappings||{};let a="";for(const[d,u]of Object.entries(s)){const i=o[d]||"default",l=i==="none";a+=`
                <div class="sound-effect-item">
                    <div class="sound-effect-info">
                        <h4>${u.name}</h4>
                        <p>${u.description}</p>
                    </div>
                    <select class="sound-preset-select" data-sound="${d}">
                        <option value="default" ${i==="default"?"selected":""}>Default</option>
                        <option value="none" ${i==="none"?"selected":""}>None</option>
                        ${Object.entries(n).map(([m,f])=>m!=="default"?`<option value="${m}" ${i===m?"selected":""}>${f.name}</option>`:"").join("")}
                    </select>
                    <button class="sound-preview-btn" data-sound="${d}">
                        üîä Preview
                    </button>
                    <button class="sound-mute-btn ${l?"muted":""}" data-sound="${d}" title="${l?"Unmute":"Mute"}">
                        ${l?"üîá":"üîä"}
                    </button>
                </div>
            `}a+=`
            <div class="sound-group-actions">
                <button class="sound-reset-all-btn" id="reset-all-sounds">
                    Reset All to Default
                </button>
                <button class="sound-advanced-btn" id="show-advanced-sounds">
                    Back to Grouped Settings
                </button>
            </div>
        `,e.innerHTML=a,this.setupIndividualSoundEventListeners(e)}setupIndividualSoundEventListeners(e){e.querySelectorAll(".sound-preset-select").forEach(o=>{o.addEventListener("change",a=>{const d=a.target.dataset.sound,u=a.target.value;this.soundManager.setCustomSound(d,u);const i=a.target.parentElement.querySelector(".sound-mute-btn");i&&(u==="none"?(i.classList.add("muted"),i.textContent="üîá",i.title="Unmute"):(i.classList.remove("muted"),i.textContent="üîä",i.title="Mute"))})}),e.querySelectorAll(".sound-preview-btn").forEach(o=>{o.addEventListener("click",a=>{const d=a.currentTarget.dataset.sound;if(a.currentTarget.parentElement.querySelector(".sound-preset-select").value==="none"){const l=o.textContent;o.textContent="üîá Silent",o.style.opacity="0.6",setTimeout(()=>{o.textContent=l,o.style.opacity="1"},500)}else this.soundManager.play(d)})}),e.querySelectorAll(".sound-mute-btn").forEach(o=>{o.addEventListener("click",a=>{const d=a.currentTarget.dataset.sound,u=a.currentTarget.parentElement.querySelector(".sound-preset-select");u.value==="none"?(u.value="default",this.soundManager.setCustomSound(d,"default"),o.classList.remove("muted"),o.textContent="üîä",o.title="Mute"):(u.value="none",this.soundManager.setCustomSound(d,"none"),o.classList.add("muted"),o.textContent="üîá",o.title="Unmute")})});const s=document.getElementById("reset-all-sounds");s&&s.addEventListener("click",async()=>{await this.confirmationDialog.show("Reset all sound effects to their default sounds?")&&this.resetAllSounds()});const n=document.getElementById("show-advanced-sounds");n&&n.addEventListener("click",()=>{this.toggleAdvancedSoundSettings()})}selectTheme(e){this.currentTheme=e,this.applyTheme(e),this.updateThemeUI(),this.updateDifficultyUI(),this.saveSettings()}applyTheme(e){let s=document.getElementById("theme-css");s||(s=document.createElement("link"),s.rel="stylesheet",s.id="theme-css",document.head.appendChild(s)),s.href=`css/themes/${e}.css`;try{Array.from(document.querySelectorAll('link[rel="stylesheet"]')).filter(d=>(d.getAttribute("href")||"").includes("/assets/wood-")||(d.href||"").includes("/assets/wood-")).forEach(d=>{d.disabled=e!=="wood"})}catch{}const n=document.getElementById("theme-css-light"),o=document.getElementById("theme-css-dark");n&&(n.media="all"),o&&(o.media="all"),document.documentElement.setAttribute("data-theme",e),document.body.className=document.body.className.replace(/light-theme|dark-theme|wood-theme/g,""),document.body.classList.add(`${e}-theme`)}async selectDifficulty(e){var o;const s=localStorage.getItem(((o=this.storage)==null?void 0:o.storageKey)||"blockdoku_game_data");let n=!1;if(s)try{const a=JSON.parse(s);n=a.score>0||a.board.some(d=>d.some(u=>u===1))}catch{n=!1}if(n&&!await this.confirmationDialog.show(`Changing difficulty to ${e.toUpperCase()} will reset your current game and you'll lose your progress. Are you sure you want to continue?`)){this.updateDifficultyUI();return}this.currentDifficulty=e,this.updateDifficultyUI(),this.saveSettings(),window.parent&&window.parent!==window?window.parent.postMessage({type:"difficultyChanged",difficulty:e},"*"):localStorage.setItem("blockdoku_pending_difficulty",e)}updateSetting(e,s){this.settings[e]=s,this.saveSettings()}updateUI(){this.updateThemeUI(),this.updateDifficultyUI(),this.updateGameSettingsUI()}updateThemeUI(){document.querySelectorAll(".theme-option").forEach(e=>{e.classList.remove("selected"),e.dataset.theme===this.currentTheme&&e.classList.add("selected")})}updateDifficultyUI(){document.querySelectorAll(".difficulty-option").forEach(e=>{if(e.classList.remove("selected"),e.dataset.difficulty===this.currentDifficulty)if(e.classList.add("selected"),this.currentTheme==="light"){e.style.color="white",e.style.textShadow="0 1px 2px rgba(0, 0, 0, 0.7)";const s=e.querySelector("h4");s&&(s.style.color="white",s.style.textShadow="0 1px 2px rgba(0, 0, 0, 0.7)");const n=e.querySelector("p");n&&(n.style.color="white",n.style.textShadow="0 1px 2px rgba(0, 0, 0, 0.7)")}else{e.style.color="",e.style.textShadow="";const s=e.querySelector("h4");s&&(s.style.color="",s.style.textShadow="");const n=e.querySelector("p");n&&(n.style.color="",n.style.textShadow="")}})}updateGameSettingsUI(){document.getElementById("enable-hints").checked=this.settings.enableHints||!1,document.getElementById("enable-timer").checked=this.settings.enableTimer||!1,document.getElementById("auto-save").checked=this.settings.autoSave!==!1,document.getElementById("show-points").checked=this.settings.showPoints||!1,this.loadEffectsSettings()}updateBlockPointsDisplay(){const e=this.settings.showPoints||!1;document.querySelectorAll(".block-info").forEach(n=>{e?n.classList.add("show-points"):n.classList.remove("show-points")})}cycleSpeedMode(){this.currentSpeedModeIndex=(this.currentSpeedModeIndex+1)%this.speedModeOrder.length;const e=this.speedModeOrder[this.currentSpeedModeIndex];this.updateSetting("speedMode",e),this.updateSpeedModeDisplay()}updateSpeedModeDisplay(){const e=document.getElementById("speed-mode-toggle"),s=document.getElementById("speed-mode-title"),n=document.getElementById("speed-mode-description");if(!e||!s||!n)return;const o=this.speedModeOrder[this.currentSpeedModeIndex],d={bonus:{title:"Bonus",description:"Faster = more points"},punishment:{title:"Punishment",description:"Faster = less points (scales with level)"},ignored:{title:"Ignored",description:"Speed doesn't affect score"}}[o];s.textContent=d.title,n.textContent=d.description}updateBuildInfo(){const e=()=>{if(B.isLoaded()){const s=document.getElementById("version-display"),n=document.getElementById("build-info");s&&(s.textContent=B.getDisplayVersion()),n&&(n.textContent=`Build: ${B.getBuildId()} (${B.getFormattedBuildDate()})`)}else setTimeout(e,100)};e()}loadHighScores(){const e=document.getElementById("high-scores-list"),s=document.getElementById("statistics-display");if(!e||!s){console.error("High scores elements not found");return}const n=this.storage.getHighScores(),o=this.storage.loadStatistics();console.log("Loading statistics:",o),n.length===0?e.innerHTML="<p>No high scores yet. Play a game to set your first record!</p>":e.innerHTML=n.map((a,d)=>`
                <div class="score-item">
                    <div class="rank">#${d+1}</div>
                    <div class="score-value">${a.score}</div>
                    <div class="score-details">${(a.difficulty||"normal").toUpperCase()} ‚Ä¢ Level ${a.level} ‚Ä¢ ${new Date(a.date).toLocaleDateString()}</div>
                </div>
            `).join(""),s.innerHTML=`
            <div class="stat-item">
                <span class="stat-label">Games Played:</span>
                <span class="stat-value">${o.gamesPlayed||0}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Score:</span>
                <span class="stat-value">${o.totalScore||0}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Best Score:</span>
                <span class="stat-value">${o.bestScore||0}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Lines:</span>
                <span class="stat-value">${o.totalLinesCleared||0}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Max Streak:</span>
                <span class="stat-value">${o.maxCombo||0}</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Combos:</span>
                <span class="stat-value">${o.totalCombos||0}</span>
            </div>
        `}refreshStatistics(){console.log("Refreshing statistics display..."),this.loadHighScores()}saveSettings(){const e={...this.settings,theme:this.currentTheme,difficulty:this.currentDifficulty};this.storage.saveSettings(e)}shareGame(){const e="https://blockdoku.523.life",s="Blockdoku - A Progressive Web App Puzzle Game";navigator.share?navigator.share({title:s,text:"Check out this awesome Blockdoku puzzle game!",url:e}).catch(o=>{console.log("Error sharing:",o),this.fallbackShare(e,s)}):this.fallbackShare(e,s)}fallbackShare(e,s){navigator.clipboard.writeText(e).then(()=>{this.showNotification("Game URL copied to clipboard!")}).catch(()=>{alert(`Share this game: ${e}`)})}shareHighScores(){const e=this.storage.getHighScores(),s=this.storage.loadStatistics();if(e.length===0){this.showNotification("No high scores to share yet!");return}let n=`üèÜ Blockdoku High Scores

`;e.slice(0,5).forEach((d,u)=>{const i=(d.difficulty||"normal").toUpperCase(),l=new Date(d.date).toLocaleDateString();n+=`#${u+1} ${d.score.toLocaleString()} (${i}) - Level ${d.level} - ${l}
`}),n+=`
üìä Statistics:
`,n+=`Games Played: ${s.gamesPlayed}
`,n+=`Total Score: ${s.totalScore.toLocaleString()}
`,n+=`Best Score: ${s.bestScore.toLocaleString()}
`,n+=`Max Combo: ${s.maxCombo}
`;const o="https://blockdoku.523.life",a="My Blockdoku High Scores";navigator.share?navigator.share({title:a,text:n,url:o}).catch(d=>{console.log("Error sharing scores:",d),this.fallbackShareScores(n,o,a)}):this.fallbackShareScores(n,o,a)}fallbackShareScores(e,s,n){navigator.clipboard.writeText(`${e}

Play Blockdoku: ${s}`).then(()=>{this.showNotification("High scores copied to clipboard!")}).catch(()=>{alert(`${e}

Play Blockdoku: ${s}`)})}showNotification(e){const s=document.createElement("div");s.style.cssText=`
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color, #007bff);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        `,s.textContent=e;const n=document.createElement("style");n.textContent=`
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `,document.head.appendChild(n),document.body.appendChild(s),setTimeout(()=>{s.remove(),n.remove()},3e3)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new M}):new M;
