class c{constructor(e=null){this.currentDifficulty="normal",this.difficultySettings=this.initializeDifficultySettings(),this.gameRules=this.initializeGameRules(),this.game=e}initializeDifficultySettings(){return{easy:{name:"Easy",shortDescription:"Larger blocks, slower pace",description:"Larger blocks, slower pace, hints available",blockSizeRange:[2,4],allowedShapes:["square2x2","square3x3","l2x2","line2","line3"],scoreMultiplier:1.5,timeLimit:null,hintsEnabled:!0,blockGenerationDelay:2e3,visualHints:!0},normal:{name:"Normal",shortDescription:"Standard block variety, moderate pace",description:"Standard block variety, moderate pace",blockSizeRange:[1,5],allowedShapes:"all",scoreMultiplier:1,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:1500,visualHints:!1},hard:{name:"Hard",shortDescription:"Smaller blocks, faster pace",description:"Smaller blocks, faster pace, no hints",blockSizeRange:[1,3],allowedShapes:["single","line2","line3","l2x2","t3x2","z3x2"],scoreMultiplier:.8,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:1e3,visualHints:!1},expert:{name:"Expert",shortDescription:"Complex shapes, time pressure",description:"Complex shapes, time pressure, limited moves",blockSizeRange:[1,4],allowedShapes:"all",scoreMultiplier:.5,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:800,visualHints:!1,moveLimit:50}}}getDetailedDescription(e,s){const i=this.difficultySettings[e];if(!i)return"";const l=i.shortDescription;if(!s||!s.difficultyDefaults)return l;const t=s.difficultyDefaults[e];if(!t)return l;const n=[];if(t.enableHints&&n.push("Enable Hints"),t.showPoints&&n.push("Show Block Points"),t.enableTimer&&n.push("Enable Timer"),t.enablePetrification&&n.push("Enable Petrification"),t.enableDeadPixels&&n.push("Enable Dead Pixels"),t.showPersonalBests&&n.push("Enable Personal Best"),t.showSpeedTimer&&n.push("Show Speed Timer"),t.enablePrizeRecognition&&n.push("Enable Prize Recognition"),t.pieceTimeoutEnabled&&n.push("Enable Piece Timeout"),t.speedMode&&t.speedMode!=="ignored"){const r=t.speedMode.charAt(0).toUpperCase()+t.speedMode.slice(1);n.push(`Speed Tracking: ${r}`)}return n.length>0?`${l}
Defaults: ${n.join(", ")}`:`${l}
Defaults: None`}getComparisonBubbles(e,s){if(!s||!s.difficultyDefaults)return[];const i=s.difficultyDefaults.normal||{},l=s.difficultyDefaults[e]||{};if(e==="hard"&&console.log("üîç Difficulty Defaults Comparison (Pure):",{difficulty:e,normalDefaults:{enableHints:i.enableHints,showPersonalBests:i.showPersonalBests,showSpeedTimer:i.showSpeedTimer,enableTimer:i.enableTimer},currentDefaults:{enableHints:l.enableHints,showPersonalBests:l.showPersonalBests,showSpeedTimer:l.showSpeedTimer,enableTimer:l.enableTimer}}),!i||!l||e==="normal")return[];const t=[],n=[{key:"enableHints",label:"Hints",emoji:"üí°"},{key:"showPoints",label:"Points",emoji:"üî¢"},{key:"enableTimer",label:"Countdown",emoji:"‚è≥"},{key:"showPersonalBests",label:"Best",emoji:"üèÜ"},{key:"showSpeedTimer",label:"Speed",emoji:"‚ö°"},{key:"enablePrizeRecognition",label:"Prizes",emoji:"üéâ"},{key:"pieceTimeoutEnabled",label:"Timeout",emoji:"‚è∞"},{key:"enableMagicBlocks",label:"Magic",emoji:"üîÆ"}];if(l.speedMode!==i.speedMode){const r=l.speedMode==="bonus"?"Bonus":l.speedMode==="punishment"?"Punish":"Speed";t.push({type:l.speedMode==="ignored"?"disabled":"enabled",label:r,emoji:"üèÉ"})}return n.forEach(r=>{const a=i[r.key],o=l[r.key];e==="hard"&&r.key==="enableHints"&&console.log("üîç Difficulty Comparison Debug (Pure Defaults):",{difficulty:e,settingKey:r.key,normalValue:a,currentValue:o,different:a!==o}),a!==o&&t.push({type:o?"enabled":"disabled",label:r.label,emoji:r.emoji})}),t}initializeGameRules(){return{basePoints:{single:10,line:100,combo:50},levelThresholds:{easy:[100,300,600,1e3,1500,2200,3e3,4e3,5200,6600],normal:[200,500,900,1400,2e3,2700,3500,4400,5400,6500],hard:[150,400,700,1100,1600,2200,2900,3700,4600,5600],expert:[100,250,450,700,1e3,1350,1750,2200,2700,3250]},comboThresholds:{easy:2,normal:3,hard:4,expert:5}}}setDifficulty(e){return this.difficultySettings[e]?(this.currentDifficulty=e,!0):!1}getCurrentDifficulty(){return this.currentDifficulty}getDifficultySettings(){return this.difficultySettings[this.currentDifficulty]}getScoreMultiplier(){return this.difficultySettings[this.currentDifficulty].scoreMultiplier}getTimeLimit(){if(this.game&&this.game.storage){const e=this.game.storage.loadSettings();let s=!1;this.game.difficultySettings?s=this.game.difficultySettings.getSettingsForDifficulty(this.currentDifficulty).enableTimer===!0:s=e.enableTimer===!0;const i=e.countdownDuration||3;if(s&&i)return console.log(`‚è±Ô∏è Countdown timer enabled: ${i} minutes (${i*60} seconds)`),i*60}return this.difficultySettings[this.currentDifficulty].timeLimit}isHintsEnabled(){return this.game&&this.game.enableHints?!0:this.difficultySettings[this.currentDifficulty].hintsEnabled}getBlockGenerationDelay(){return this.difficultySettings[this.currentDifficulty].blockGenerationDelay}hasVisualHints(){return this.difficultySettings[this.currentDifficulty].visualHints}getMoveLimit(){return this.difficultySettings[this.currentDifficulty].moveLimit||null}getAllowedShapes(){return this.difficultySettings[this.currentDifficulty].allowedShapes}getBlockSizeRange(){return this.difficultySettings[this.currentDifficulty].blockSizeRange}getLevelThresholds(){return this.gameRules.levelThresholds[this.currentDifficulty]}getComboThreshold(){return this.gameRules.comboThresholds[this.currentDifficulty]}calculateScore(e,s=1){const i=this.getScoreMultiplier();return Math.floor(e*i)}shouldGenerateNewBlocks(e,s){const i=this.getLevelThresholds();return s<=i.length&&e>=i[s-1]}getDifficultyInfo(){const e=this.getDifficultySettings();return{name:e.name,description:e.description,features:{hints:e.hintsEnabled,timer:e.timeLimit!==null,moveLimit:e.moveLimit!==null}}}getAvailableDifficulties(){return Object.keys(this.difficultySettings).map(e=>({key:e,...this.difficultySettings[e]}))}reset(){this.currentDifficulty="normal"}}export{c as DifficultyManager};
