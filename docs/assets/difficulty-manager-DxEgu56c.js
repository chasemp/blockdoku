class c{constructor(e=null){this.currentDifficulty="normal",this.difficultySettings=this.initializeDifficultySettings(),this.gameRules=this.initializeGameRules(),this.game=e}initializeDifficultySettings(){return{easy:{name:"Easy",shortDescription:"Larger blocks, slower pace",description:"Larger blocks, slower pace, hints available",blockSizeRange:[2,4],allowedShapes:["square2x2","square3x3","l2x2","line2","line3"],scoreMultiplier:1.5,timeLimit:null,hintsEnabled:!0,blockGenerationDelay:2e3,visualHints:!0},normal:{name:"Normal",shortDescription:"Standard block variety, moderate pace",description:"Standard block variety, moderate pace",blockSizeRange:[1,5],allowedShapes:"all",scoreMultiplier:1,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:1500,visualHints:!1},hard:{name:"Hard",shortDescription:"Smaller blocks, faster pace",description:"Smaller blocks, faster pace, no hints",blockSizeRange:[1,3],allowedShapes:["single","line2","line3","l2x2","t3x2","z3x2"],scoreMultiplier:.8,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:1e3,visualHints:!1},expert:{name:"Expert",shortDescription:"Complex shapes, time pressure",description:"Complex shapes, time pressure, limited moves",blockSizeRange:[1,4],allowedShapes:"all",scoreMultiplier:.5,timeLimit:null,hintsEnabled:!1,blockGenerationDelay:800,visualHints:!1,moveLimit:50}}}getDetailedDescription(e,l){const t=this.difficultySettings[e];if(!t)return"";const i=t.shortDescription;if(!l||!l.difficultyDefaults)return i;const s=l.difficultyDefaults[e];if(!s)return i;const n=[];if(s.enableHints&&n.push("Enable Hints"),s.showPoints&&n.push("Show Block Points"),s.enableTimer&&n.push("Enable Timer"),s.enablePetrification&&n.push("Enable Petrification"),s.enableDeadPixels&&n.push("Enable Dead Pixels"),s.showPersonalBests&&n.push("Enable Personal Best"),s.showSpeedTimer&&n.push("Show Speed Timer"),s.enablePrizeRecognition&&n.push("Enable Prize Recognition"),s.pieceTimeoutEnabled&&n.push("Enable Piece Timeout"),s.speedMode&&s.speedMode!=="ignored"){const r=s.speedMode.charAt(0).toUpperCase()+s.speedMode.slice(1);n.push(`Speed Tracking: ${r}`)}return n.length>0?`${i}
Defaults: ${n.join(", ")}`:`${i}
Defaults: None`}getComparisonBubbles(e,l){if(!l||!l.difficultyDefaults)return[];const t=l.difficultyDefaults.normal||{},i=l.difficultyDefaults[e]||{};if(e==="hard"&&console.log("üîç Difficulty Defaults Comparison (Pure):",{difficulty:e,normalDefaults:{enableHints:t.enableHints,showPersonalBests:t.showPersonalBests,showSpeedTimer:t.showSpeedTimer,enableTimer:t.enableTimer},currentDefaults:{enableHints:i.enableHints,showPersonalBests:i.showPersonalBests,showSpeedTimer:i.showSpeedTimer,enableTimer:i.enableTimer}}),!t||!i||e==="normal")return[];const s=[],n=[{key:"enableHints",label:"Hints",emoji:"üí°"},{key:"showPoints",label:"Points",emoji:"üî¢"},{key:"enableTimer",label:"Countdown",emoji:"‚è≥"},{key:"showPersonalBests",label:"Best",emoji:"üèÜ"},{key:"showSpeedTimer",label:"Speed",emoji:"‚ö°"},{key:"enablePrizeRecognition",label:"Prizes",emoji:"üéâ"},{key:"pieceTimeoutEnabled",label:"Timeout",emoji:"‚è∞"},{key:"enableMagicBlocks",label:"Magic",emoji:"üîÆ"}];if(i.speedMode!==t.speedMode){const r=i.speedMode==="bonus"?"Bonus":i.speedMode==="punishment"?"Punish":"Speed";s.push({type:i.speedMode==="ignored"?"disabled":"enabled",label:r,emoji:"üèÉ"})}return n.forEach(r=>{const a=t[r.key],o=i[r.key];e==="hard"&&r.key==="enableHints"&&console.log("üîç Difficulty Comparison Debug (Pure Defaults):",{difficulty:e,settingKey:r.key,normalValue:a,currentValue:o,different:a!==o}),a!==o&&s.push({type:o?"enabled":"disabled",label:r.label,emoji:r.emoji})}),s}initializeGameRules(){return{basePoints:{single:10,line:100,combo:50},levelThresholds:{easy:[100,300,600,1e3,1500,2200,3e3,4e3,5200,6600],normal:[200,500,900,1400,2e3,2700,3500,4400,5400,6500],hard:[150,400,700,1100,1600,2200,2900,3700,4600,5600],expert:[100,250,450,700,1e3,1350,1750,2200,2700,3250]},comboThresholds:{easy:2,normal:3,hard:4,expert:5}}}setDifficulty(e){return this.difficultySettings[e]?(this.currentDifficulty=e,!0):!1}getCurrentDifficulty(){return this.currentDifficulty}getDifficultySettings(){return this.difficultySettings[this.currentDifficulty]}getScoreMultiplier(){return this.difficultySettings[this.currentDifficulty].scoreMultiplier}getTimeLimit(){if(this.game&&this.game.storage){const e=this.game.storage.loadSettings(),l=this.game.difficulty||this.currentDifficulty;let t=!1;this.game.difficultySettings?t=this.game.difficultySettings.getSettingsForDifficulty(l).enableTimer===!0:t=e.enableTimer===!0;const i=e.countdownDuration||3;if(t&&i)return console.log(`‚è±Ô∏è Countdown timer enabled for ${l}: ${i} minutes (${i*60} seconds)`),i*60}return this.difficultySettings[this.currentDifficulty].timeLimit}isHintsEnabled(){return this.game&&this.game.enableHints?!0:this.difficultySettings[this.currentDifficulty].hintsEnabled}getBlockGenerationDelay(){return this.difficultySettings[this.currentDifficulty].blockGenerationDelay}hasVisualHints(){return this.difficultySettings[this.currentDifficulty].visualHints}getMoveLimit(){return this.difficultySettings[this.currentDifficulty].moveLimit||null}getAllowedShapes(){return this.difficultySettings[this.currentDifficulty].allowedShapes}getBlockSizeRange(){return this.difficultySettings[this.currentDifficulty].blockSizeRange}getLevelThresholds(){return this.gameRules.levelThresholds[this.currentDifficulty]}getComboThreshold(){return this.gameRules.comboThresholds[this.currentDifficulty]}calculateScore(e,l=1){const t=this.getScoreMultiplier();return Math.floor(e*t)}shouldGenerateNewBlocks(e,l){const t=this.getLevelThresholds();return l<=t.length&&e>=t[l-1]}getDifficultyInfo(){const e=this.getDifficultySettings();return{name:e.name,description:e.description,features:{hints:e.hintsEnabled,timer:e.timeLimit!==null,moveLimit:e.moveLimit!==null}}}getAvailableDifficulties(){return Object.keys(this.difficultySettings).map(e=>({key:e,...this.difficultySettings[e]}))}reset(){this.currentDifficulty="normal"}}export{c as DifficultyManager};
