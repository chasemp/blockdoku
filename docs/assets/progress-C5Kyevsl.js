import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css             *//* empty css             */import{L as o}from"./level-manager-BX9v6P63.js";import{G as r}from"./game-storage-DL9oYqbD.js";class c{constructor(){this.storage=new r,this.levelManager=new o(null,this.storage),this.currentDifficulty="normal",this.selectedLevel=1,this.progressData=this.storage.loadProgressModeData()||this.getDefaultProgressData(),this.initializePage()}initializePage(){this.loadTheme(),this.setupEventListeners(),this.loadProgressData(),this.renderDifficultySelection(),this.renderProgressStats()}setupEventListeners(){document.getElementById("back-to-settings").addEventListener("click",()=>{window.location.href="gamesettings.html"}),document.getElementById("back-to-game").addEventListener("click",()=>{window.location.href="index.html"}),document.querySelectorAll(".difficulty-option").forEach(e=>{e.addEventListener("click",t=>{const s=t.currentTarget.dataset.difficulty;this.selectDifficulty(s)})}),document.getElementById("change-difficulty").addEventListener("click",()=>{this.showDifficultySelection()}),document.getElementById("back-to-levels").addEventListener("click",()=>{this.showLevelSelection()}),document.getElementById("start-level-btn").addEventListener("click",()=>{this.startSelectedLevel()})}selectDifficulty(e){this.currentDifficulty=e,this.showLevelSelection(),this.renderLevelGrid()}showDifficultySelection(){document.getElementById("difficulty-section").style.display="block",document.getElementById("levels-section").style.display="none",document.getElementById("level-details").style.display="none"}showLevelSelection(){document.getElementById("difficulty-section").style.display="none",document.getElementById("levels-section").style.display="block",document.getElementById("level-details").style.display="none"}showLevelDetails(e){this.selectedLevel=e,document.getElementById("difficulty-section").style.display="none",document.getElementById("levels-section").style.display="none",document.getElementById("level-details").style.display="block",this.renderLevelDetails(e)}renderDifficultySelection(){["easy","normal","hard","expert"].forEach(t=>{const s=this.getCompletedLevelsCount(t),l=document.getElementById(`${t}-completed`);l&&(l.textContent=`${s}/30`)}),document.getElementById("selected-difficulty-title").textContent=`${this.currentDifficulty.charAt(0).toUpperCase()+this.currentDifficulty.slice(1)} Level Management`}renderLevelGrid(){const e=document.getElementById("levels-grid");e.innerHTML="";for(let t=1;t<=30;t++){const s=this.createLevelButton(t);e.appendChild(s)}}createLevelButton(e){const t=document.createElement("button");t.className="level-button",t.dataset.level=e;const s=this.isLevelCompleted(e,this.currentDifficulty),l=this.isLevelUnlocked(e,this.currentDifficulty);return s?t.classList.add("completed"):l||t.classList.add("locked"),t.innerHTML=`
            <div class="level-number">${e}</div>
            <div class="level-status">
                ${s?"âœ“":l?"â—‹":"ðŸ”’"}
            </div>
        `,l&&t.addEventListener("click",()=>{this.showLevelDetails(e)}),t}renderLevelDetails(e){const t=this.levelManager.getLevelDefinition(e,this.currentDifficulty);if(!t){console.error(`Level ${e} not found for difficulty ${this.currentDifficulty}`);return}document.getElementById("level-name").textContent=`Level ${e}`,document.getElementById("level-description-text").textContent="Complete the objectives to advance to the next level.";const s=document.getElementById("level-objectives-list");if(s.innerHTML="",t.objectives.scoreTarget){const n=document.createElement("li");n.textContent=`Score ${t.objectives.scoreTarget} points`,s.appendChild(n)}if(t.objectives.maxMoves){const n=document.createElement("li");n.textContent=`Complete in ${t.objectives.maxMoves} moves or less`,s.appendChild(n)}if(t.objectives.comboRequirement>0){const n=document.createElement("li");n.textContent=`Achieve ${t.objectives.comboRequirement} combos`,s.appendChild(n)}const l=document.getElementById("level-rewards-list");if(l.innerHTML="",t.rewards&&t.rewards.length>0)t.rewards.forEach(n=>{const i=document.createElement("li");i.textContent=this.formatReward(n),l.appendChild(i)});else{const n=document.createElement("li");n.textContent="Progress towards next level",l.appendChild(n)}}formatReward(e){return e.startsWith("theme:")?`Unlock ${e.split(":")[1]} theme`:e.startsWith("block:")?`Unlock ${e.split(":")[1]} block type`:e}startSelectedLevel(){this.storage.saveProgressModeData({...this.progressData,selectedLevel:this.selectedLevel,selectedDifficulty:this.currentDifficulty}),window.location.href=`index.html?mode=progress&level=${this.selectedLevel}&difficulty=${this.currentDifficulty}`}renderProgressStats(){const e=this.getTotalCompletedLevels(),t=this.getTotalAchievements(),s=this.getTotalRewards();document.getElementById("total-completed").textContent=e,document.getElementById("total-achievements").textContent=t,document.getElementById("total-rewards").textContent=s}getCompletedLevelsCount(e){var t;return this.progressData.completedLevels&&((t=this.progressData.completedLevels[e])==null?void 0:t.length)||0}getTotalCompletedLevels(){return["easy","normal","hard","expert"].reduce((t,s)=>t+this.getCompletedLevelsCount(s),0)}getTotalAchievements(){return this.progressData.achievements?Object.keys(this.progressData.achievements).length:0}getTotalRewards(){return this.progressData.unlockedRewards?this.progressData.unlockedRewards.length:0}isLevelCompleted(e,t){var s;return this.progressData.completedLevels&&((s=this.progressData.completedLevels[t])==null?void 0:s.includes(e))||!1}isLevelUnlocked(e,t){return e===1?!0:this.isLevelCompleted(e-1,t)}getDefaultProgressData(){return{completedLevels:{easy:[],normal:[],hard:[],expert:[]},achievements:{},unlockedRewards:[],selectedLevel:1,selectedDifficulty:"normal"}}loadProgressData(){const e=this.storage.loadProgressModeData();e&&(this.progressData={...this.getDefaultProgressData(),...e})}loadTheme(){const t=this.storage.loadSettings().theme||"wood";this.applyTheme(t)}applyTheme(e){console.log("Progress page applying theme:",e);const t=document.getElementById("theme-css");t&&(t.href=`css/themes/${e}.css`),document.documentElement.setAttribute("data-theme",e);const s={wood:"#8B4513",light:"#007bff",dark:"#343a40"},l=document.querySelector('meta[name="theme-color"]');l&&l.setAttribute("content",s[e]||s.wood)}}document.addEventListener("DOMContentLoaded",()=>{new c});
